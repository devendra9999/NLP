<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>Collection VBO</bpr:name>
    <bpr:release-notes />
    <bpr:created>2021-03-03 13:24:35Z</bpr:created>
    <bpr:package-id>-1</bpr:package-id>
    <bpr:package-name>&lt;Adhoc Package&gt;</bpr:package-name>
    <bpr:user-created-by>MG9203L@ad.esi.adp.com</bpr:user-created-by>
    <bpr:contents count="3">
        <object id="6f9680f1-616c-4884-b58c-42ed51446377" name="Utility - Collection Manipulation" xmlns="http://www.blueprism.co.uk/product/process"><process name="Utility - Collection Manipulation" version="4.2.55" bpversion="6.5.1.14401" narrative="Utility functions for manipulating collections." byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>b30f5d67-5c3c-49c9-8f9b-66d573097498</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="9a74af4c-280a-4e30-bdbb-21295b6256ca" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="53950e2c-2499-41fc-aed2-207a6c7431fd" type="Normal" published="False"><name>Utility Functions Test</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d8e5be7a-93aa-4322-99bf-00edea37bbc2" type="Normal" published="True"><name>Sort Collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ffab882f-007c-48a5-8f84-8f5f1bfd4d6a" type="Normal" published="True"><name>Reverse Collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7e683388-9c88-4ec1-9198-ae559b6488cf" type="Normal" published="True"><name>Compare Single Col Collection - Returns Unmatched Values</name><view><camerax>0</camerax><cameray>83</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="822edf4b-c142-4457-a8ff-4ff1eb0e5b2c" type="Normal" published="True"><name>Compare Collections - Returns matched Values</name><view><camerax>157</camerax><cameray>63</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2954e4fb-0fc4-435b-852d-be185135e6fb" type="Normal" published="True"><name>Add Row at index</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="45722e3e-ba81-4faa-b738-0f7e569f2a40" type="Normal" published="True"><name>Sum Values</name><view><camerax>-213</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4c773bb1-3fe6-4fe1-a50f-9ccd296476c1" type="Normal" published="True"><name>Distinct values in a column</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cd8fefb9-4622-4ea7-8287-e64b86d7e513" type="Normal" published="True"><name>Merge Collection</name><view><camerax>-100</camerax><cameray>3</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="76943739-36b9-46bc-8f95-e1b6342bc8a6" type="Normal" published="True"><name>Split Collection</name><view><camerax>0</camerax><cameray>165</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a0cf6615-20c0-4910-9990-0f79f5f30bca" type="Normal" published="True"><name>Transpose Collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a9f3108d-ca87-4551-b567-9c64ef05cf0c" type="Normal" published="True"><name>Filter Collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e277cc2b-72b8-47e9-8a1b-e8530eb19a09" type="Normal" published="True"><name>Get Collection Fields</name><view><camerax>42</camerax><cameray>-4</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4d41bfc8-e552-41ae-9e45-65dc3d1f7276" type="Normal" published="True"><name>Field Exists</name><view><camerax>54</camerax><cameray>127</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="02440e37-e805-4bfc-8bea-7d07952d6a7c" type="Normal" published="True"><name>Field Exists - Parallel Run</name><view><camerax>54</camerax><cameray>127</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="bcde64eb-f856-4440-a6c0-d83f40f0cf4b" type="Normal" published="True"><name>Rename Collection Fields</name><view><camerax>207</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea" type="Normal" published="True"><name>Rename Collection Fields - Copy</name><view><camerax>207</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="198ce3c6-ecbf-4203-a609-b15429defe0e" type="Normal" published="True"><name>Read Collection Field</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="05992810-1be4-4455-84e8-10579308ab87" type="Normal" published="True"><name>Set Collection Field</name><view><camerax>276</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7a9aa259-fe07-4035-8411-23737559c975" type="Normal" published="True"><name>Collection Contains Field</name><view><camerax>17</camerax><cameray>356</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a" type="Normal" published="True"><name>Collection Contains Value</name><view><camerax>-93</camerax><cameray>-24</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2a0b8565-e059-4412-ad46-ad8f244fead3" type="Normal" published="True"><name>Get Collection Index from Value</name><view><camerax>-93</camerax><cameray>-24</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d" type="Normal" published="True"><name>Get Collection Index from Value - Copy</name><view><camerax>-93</camerax><cameray>18</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a2d64ca7-f8be-4aff-8600-00cb2d4fdf35" type="Normal" published="True"><name>Collection Contains Value SubString</name><view><camerax>-93</camerax><cameray>-24</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="cdf2a7f1-a351-441a-8d36-bc92af66650a" type="Normal" published="True"><name>Copy Rows</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="51f694a8-5305-4a38-9b41-a98998f2f7ca" type="Normal" published="True"><name>Append Rows to Collection</name><view><camerax>-37</camerax><cameray>171</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a474299b-5c1c-4873-a3af-4dd0d3bd03ff" type="Normal" published="True"><name>Append Field (Text)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7a34b011-0bb7-4f26-b061-298b3c067161" type="Normal" published="True"><name>Append Field (DateTime)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="dedeacd7-8e54-456e-920c-c23fc62e5789" type="Normal" published="True"><name>Append Field (Collection)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="65451129-b7a2-4c2f-a12d-9086bd314f53" type="Normal" published="True"><name>Append Field (Number)</name><view><camerax>-100</camerax><cameray>-42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="67bcfaab-2af9-489a-bd35-96b60f2870fb" type="Normal" published="True"><name>Add Value To Column</name><view><camerax>-100</camerax><cameray>-42</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e541422a-fb55-4817-9547-5cdcd3fe77cf" type="Normal" published="True"><name>Add Value to Column(Text)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9ca43712-86a7-4260-bf89-f8b7518ddb60" type="Normal" published="True"><name>Add Value to Column(Text) By Row Condition</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e64fbfd3-6797-49fd-a53e-3d80493aae66" type="Normal" published="True"><name>Add Prefix/Suffix to Column(Text)</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9" type="Normal" published="True"><name>Rename Field</name><view><camerax>-100</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1d7b6202-d743-4485-9101-839f4651c406" type="Normal" published="True"><name>Delete Field</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="df662579-558c-4cc9-88df-8c680b67b41d" type="Normal" published="True"><name>Delete Column</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3a772458-463d-46cf-8451-6cf5b4aeae30" type="Normal" published="True"><name>Remove Null Rows</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="b8e3b975-d485-49a3-b962-864d13a96e05" type="Normal" published="True"><name>Set Column Names From First Row</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c8d54842-b057-4678-851e-c6a84eb1354b" type="Normal" published="True"><name>Set First Row from Column Names</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="87541f35-d834-4d99-8fd3-16ec994a9990" type="Normal" published="True"><name>Set Column Names From Expected Collection</name><view><camerax>0</camerax><cameray>-62</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="d1eee74f-1582-4c3e-96c8-b94f1535d7e1" type="Normal" published="True"><name>Fill Blanks</name><view><camerax>-195</camerax><cameray>-21</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="eb03a051-75a8-4093-a383-6c6fecfbb736" type="Normal" published="True"><name>Remove dots from headers</name><view><camerax>0</camerax><cameray>-22</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="980e41ce-f2f3-42fd-8da9-c3d63784d0a8" type="Normal" published="True"><name>Fill Blanks  with Value</name><view><camerax>-195</camerax><cameray>-21</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="199bcb60-3d82-4aaa-91d1-c2497135326e" type="Normal" published="True"><name>Remove enters from headers</name><view><camerax>0</camerax><cameray>36</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ff1a4e73-9c6b-4708-98f4-a05d8215609c" type="Normal" published="True"><name>Remove spaces from headers</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="fa6ed646-8ae1-479e-9845-b1dc9ac3b560" type="Normal" published="True"><name>Remove Empty Rows</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="03ffe425-1a93-43ce-828a-68932853dd37" type="Normal" published="True"><name>Remove Row At Index</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9f8f5c4e-bde6-4fce-9e17-d900f0bbf053" type="Normal" published="True"><name>Trim headers</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="39b89826-71e0-4668-8d04-c535f08bd13f" type="Normal" published="True"><name>Find Value Index</name><view><camerax>0</camerax><cameray>49</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="44048047-cae7-4d78-b237-d65a9afd4b5a" type="Normal" published="True"><name>Find Value Index - New</name><view><camerax>0</camerax><cameray>49</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9b268688-af7c-4803-85a9-dceab8c00654" type="Normal" published="True"><name>Count Distinct</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="79afd981-15a2-4fe9-9023-bda54e603c0d" type="Normal" published="True"><name>Write Collection To Text File</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="1123d57c-cfe8-424d-99a9-2d47860a0482" type="Normal" published="True"><name>CleanMemory</name><view><camerax>283</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="34b3f311-667d-4be9-9fad-2ae5aa1abba8" type="Normal" published="True"><name>ReplaceCollectionValues</name><view><camerax>127</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="43162cbb-b906-4c41-bb49-1dea3a97055d" type="Normal" published="True"><name>Trim Values in a Collection</name><view><camerax>82</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c8c48625-056a-468c-a1ab-36e4f088b85c" type="Normal" published="True"><name>Find Sum Based In Column</name><view><camerax>-84</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="f9718f48-96ae-4df7-8125-63d99736f39e" type="Normal" published="True"><name>Custom_Add Column</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="9afa76c4-d9c2-436f-ac8e-cc353d553f12" type="Normal" published="True"><name>Get 1 column from collection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="d8c547cc-60d0-459b-876f-90bf696a5757" name="Start" type="Start"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>807e7d33-91e2-4241-a85e-ea0718fc487d</onsuccess></stage><stage stageid="807e7d33-91e2-4241-a85e-ea0718fc487d" name="End" type="End"><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1a8c9ebd-54e1-442f-a6c7-e87df3b59232" name="Stage1" type="ProcessInfo"><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference><reference>Microsoft.VisualBasic.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import><import>System.IO</import><import>System.XML</import><import>System.Diagnostics</import><import>Microsoft.VisualBasic</import><import>System.Data</import><import>system.text.regularexpressions</import><import>Microsoft.VisualBasic</import><import>System.Collections</import><import>System.Text</import></imports><language>visualbasic</language><globalcode><![CDATA[


]]></globalcode><code><![CDATA[Public CommonDictionary as New System.Collections.Generic.Dictionary(Of String, String)

Private Iterator as Generic.IEnumerator(Of String)

Public Function GetDataTable(ByVal ColumnNamesCSV As String, ByVal ColumnTypesCSV As String) As DataTable

	Dim objTable As DataTable
	Dim objColumn As DataColumn
	Dim aColumnNames As String() = ColumnNamesCSV.Split(",")
	Dim aColumnTypes As String() = ColumnTypesCSV.Split(",")

	Try
		objTable = New DataTable
		For i As Integer = 0 To aColumnNames.Length - 1
			objColumn = New DataColumn 
			objColumn.DataType = System.Type.GetType(aColumnTypes(i).Trim)
			objColumn.ColumnName = aColumnNames(i).Trim
			objTable.Columns.Add(objColumn)
		Next
		
	Catch e As Exception
		objTable = nothing	
	End Try

	Return objTable

End Function


private function GetBluePrismDAtaType(DotNetType AS Type) As String
   Select Case True
      Case DotNetType.Equals(GetType(Timespan))
         return "timespan"
      Case DotNetType Is GetType(DAteTime)
         return "datetime"
      Case DotNetType Is GetType(Decimal), _
				DotNetType Is GetType(Integer), _
					DotNetType Is GetType(Double), _
						DotNetType Is GetType(Single)
         return "number"
      Case DotNetType Is GetType(System.Drawing.Bitmap)
         return "image"
      Case DotNetType Is GetType(Byte())
         return "binary"
      Case DotNetType Is GetType(Boolean)
         return "flag"
      Case Else
         return "text"
   End Select
End Function


Private Function CloneDataRow(R As DataRow, ColumnCount As Integer) As Object()
	Dim RetVal(ColumnCount - 1) As Object
	For I As Integer = 0 to ColumnCount - 1
		RetVal(I) = R(I)
	Next

	Return RetVal
End Function]]></code></stage><stage stageid="0bf7814a-647b-4bcb-b6a6-3d24dfd5b736" name="Clean Up" type="SubSheetInfo"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="0c56e2f8-68ce-48a3-97ad-81e1f076e9ce" name="new" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="2271a79e-27e5-4434-b5be-146e02946317" name="new" type="Note"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>180</displaywidth><displayheight>230</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="36451c72-b274-4817-a153-beb1e8a6e76a" name="Start" type="Start"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>9a8c4505-8606-4a0c-b118-09a6b9932b3b</onsuccess></stage><stage stageid="9a8c4505-8606-4a0c-b118-09a6b9932b3b" name="End" type="End"><subsheetid>9a74af4c-280a-4e30-bdbb-21295b6256ca</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1d87c6c0-f260-46fc-99c2-ffcbf6ee0497" name="Sort Collection" type="SubSheetInfo"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative>Sorts a collection according to the specified field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="785a8eca-82a6-43fe-9f16-1803844d88ce" name="Start" type="Start"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have been sorted." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to sort." stage="Collection In" /><input type="text" name="Sort Field" narrative="The field to sort by." stage="Sort Field" /><input type="flag" name="Ascending Order" narrative="True to sort in ascending order." stage="Ascending Order" /></inputs><onsuccess>fbac0e5c-5410-45f1-98d7-646797398b04</onsuccess></stage><stage stageid="0c95c136-f8cf-49a1-98c0-a4c1e2334eca" name="End" type="End"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Sorted Collection" narrative="The sorted collection." stage="Collection Out" /><output type="flag" name="Success" narrative="True if sorting was successful." stage="Success" /><output type="text" name="Message" narrative="An error message when sorting failed." stage="Message" /></outputs></stage><stage stageid="e8e991cc-351b-4484-9825-b5c1f0d894d1" name="Collection Out" type="Collection"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="fbac0e5c-5410-45f1-98d7-646797398b04" name="Sort Collection" type="Code"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Sort Field" expr="[Sort Field]" /><input type="flag" name="Ascending" expr="[Ascending Order]" /></inputs><outputs><output type="collection" name="Sorted Collection" stage="Collection Out" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>0c95c136-f8cf-49a1-98c0-a4c1e2334eca</onsuccess><code><![CDATA[


Try

 

            If Ascending Then

			Dim dataView As New DataView(Collection,"", Sort_Field & " ASC", DataViewRowState.CurrentRows)

			Sorted_Collection = dataView.ToTable()


                        '

            Else

			Dim dataView As New DataView(Collection,"", Sort_Field & " DESC", DataViewRowState.CurrentRows)

			Sorted_Collection = dataView.ToTable()
                       

            End If

			
            

            Success = True

            Message = ""

 

Catch e As Exception

            Success = False

            Message = e.Message

End Try]]></code></stage><stage stageid="6f6e54f2-77b8-4f24-ae2f-46a2143d9815" name="Ascending Order" type="Data"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="2fb49db2-332e-4bdb-a52e-53546b2a25e8" name="Message" type="Data"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>210</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8170a296-23ef-4f36-88ea-12b93bc41486" name="Success" type="Data"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>180</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d46e7f41-9e7a-4a0a-b1be-d440d57e4020" name="Sort Field" type="Data"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="adfd612b-98f8-4902-8526-2bda2e03f814" name="Get Collection Fields" type="SubSheetInfo"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><narrative>Creates a collection with a Name and Datatype field which is then populated using the incoming collections field names and data types.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="73b6f098-584e-441e-8b2d-e231b971bdb2" name="Start" type="Start"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="A new collection will be created containing the collections field data." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection to get the fields from." stage="Input Collection" /></inputs><onsuccess>39b91b36-f03d-4fa7-9bf2-47470e1d9703</onsuccess></stage><stage stageid="e2308e18-4f98-4f62-9ff6-a4c52222c3aa" name="End" type="End"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Fields" narrative="A collection containing the fields." stage="Fields" /></outputs></stage><stage stageid="39b91b36-f03d-4fa7-9bf2-47470e1d9703" name="Get Collection Fields" type="Code"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Fields" stage="Fields" /></outputs><onsuccess>e2308e18-4f98-4f62-9ff6-a4c52222c3aa</onsuccess><code><![CDATA[Fields = New DataTable()
Fields.Columns.Add("Field Name", GetType(String))
Fields.Columns.Add("Data Type", GetType(String))

For Each Column As DataColumn In Input_Collection.Columns
   Dim DataType As String = GetBluePrismDataType(Column.DataType)
   Fields.Rows.Add(New Object() {Column.ColumnName, DataType})
Next
]]></code></stage><stage stageid="a16b1987-a205-4bf6-8a33-ed2167c201ff" name="Fields" type="Collection"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><narrative></narrative><displayx>135</displayx><displayy>90</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Field Name" type="text" /><field name="Data Type" type="text" /></collectioninfo></stage><stage stageid="15198914-f283-4549-a823-c7b71d71d160" name="Utility Functions Test" type="SubSheetInfo"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="6b30836d-2593-48c6-a021-b6b3e92ad88a" name="Start" type="Start"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f5830837-58db-473d-b7dc-4651a10f79c6</onsuccess></stage><stage stageid="5a5bf1e7-2072-4226-96ba-ab3d0a656589" name="End" type="End"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f5830837-58db-473d-b7dc-4651a10f79c6" name="Get Collection Fields" type="SubSheet"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Defined Collection 1]" /></inputs><outputs><output type="collection" name="Collection Fields" stage="Collection Fields" /></outputs><onsuccess>5a5bf1e7-2072-4226-96ba-ab3d0a656589</onsuccess><processid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</processid></stage><stage stageid="d402363f-8a48-4418-b0d9-2bef5037bc67" name="Input Collection" type="Collection"><subsheetid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e8e6edcb-f2fe-4582-9037-5ddb4ca15572" name="Collection Fields" type="Collection"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><narrative></narrative><displayx>105</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="980dd5f0-a047-4672-9a7a-18632a5826a0" name="Defined Collection 1" type="Collection"><subsheetid>53950e2c-2499-41fc-aed2-207a6c7431fd</subsheetid><loginhibit /><narrative></narrative><displayx>-150</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="My Text Field" type="text" /><field name="My Number Field" type="number" /><field name="My DateTime Field" type="datetime" /><field name="My TimeSpan Field" type="timespan" /><field name="My Flag Field" type="flag" /><field name="My Image Field" type="image" /></collectioninfo><initialvalue><row><field name="My Text Field" type="text" value="Test Text" /><field name="My Number Field" type="number" value="5" /><field name="My DateTime Field" type="datetime" value="2009-07-23 01:46:26Z" /><field name="My TimeSpan Field" type="timespan" value="0.00:03:42" /><field name="My Flag Field" type="flag" value="True" /><field name="My Image Field" type="image" value="" /></row><row><field name="My Text Field" type="text" value="asdf" /><field name="My Number Field" type="number" value="10" /><field name="My DateTime Field" type="datetime" value="" /><field name="My TimeSpan Field" type="timespan" value="0.00:00:00" /><field name="My Flag Field" type="flag" value="False" /><field name="My Image Field" type="image" value="" /></row></initialvalue></stage><stage stageid="0e6f80ff-bfb9-4d47-8e5a-5299a5873467" name="Read Collection Field" type="SubSheetInfo"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><narrative>Reads a field with a given name and at the specified row from the collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9d660720-4bed-4ea8-8ad6-56fa0b19cfb4" name="Start" type="Start"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Row Index" narrative="The row index within the collection to read from. The index is from 0 to N-1 (where N is the total number of rows in the collection)." stage="Row Index" /><input type="collection" name="Collection" narrative="The collection to read." stage="Collection" /><input type="text" name="Field Name" narrative="The field within the collection to read." stage="Field Name" /></inputs><onsuccess>c4bf6e49-1d07-4d60-8b44-fd35a2009654</onsuccess></stage><stage stageid="2a6d86a8-8937-4d4b-9da4-32813d06a0bf" name="End" type="End"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Value Read" narrative="The value of the requested field as text." stage="Value Read" /></outputs></stage><stage stageid="d43ae257-4559-4fa8-9b0b-1f49bd80a301" name="Row Index" type="Data"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><narrative></narrative><displayx>90</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bd207bc4-8fe0-4f01-94e6-b289cdb60e38" name="Collection" type="Collection"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><narrative></narrative><displayx>225</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="745ce225-df49-4b02-b12c-e9e2068ca6aa" name="Field Name" type="Data"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c4bf6e49-1d07-4d60-8b44-fd35a2009654" name="Read Field" type="Code"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll" expr="[Collection]" /><input type="text" name="FieldName" expr="[Field Name]" /><input type="number" name="RowIndex" expr="[Row Index]" /></inputs><outputs><output type="text" name="Value Read" stage="Value Read" /></outputs><onsuccess>4c50ed56-655c-4c71-9ae8-865c3fbd0330</onsuccess><code><![CDATA[
If RowIndex < 0 OrElse Coll.Rows.Count <= RowIndex Then
	Throw New ApplicationException("The supplied row index falls outside of the valid range.")
End If

If Not Coll.Columns.Contains(FieldName) Then
   Throw New ApplicationException("The collection does not contain a field with the name '" & FieldName & "'")
End If

Value_Read = CStr(Coll.Rows(RowIndex)(FieldName))]]></code></stage><stage stageid="43376e9f-73fa-4757-affa-330da5d1e6b1" name="Value Read" type="Data"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><narrative></narrative><displayx>105</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ee1c02ab-bf62-48df-b0de-79c4f254d5df" name="Set Collection Field" type="SubSheetInfo"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative>Updates a single value in a collection by the given field name and row index.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4fe6d4f3-e989-4636-b373-9a32fc41d450" name="Start" type="Start"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Row Index" narrative="The index of the row in which to set the value. The index is from 0 to N-1 (where N is the total number of rows in the collection)." stage="Row Index" /><input type="collection" name="Collection" narrative="The collection in which to set the value." stage="Collection" /><input type="text" name="Field Name" narrative="The name of the field in which to set the value" stage="Field Name" /><input type="text" name="New Value" narrative="The value as text to set." stage="New Value" /></inputs><onsuccess>c7b9c9ed-85d9-4449-a150-5182797dc6f3</onsuccess></stage><stage stageid="2be33601-0c29-45c7-bc7e-1a5a8d1c19b2" name="End" type="End"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Updated Collection" narrative="The collection which now has the value set." stage="Updated Collection" /></outputs></stage><stage stageid="e2d67695-6463-4e93-b5cd-e3b9805bb0cf" name="Row Index" type="Data"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative></narrative><displayx>195</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="26046a1c-efef-4b6b-baa7-1880ae887576" name="Collection" type="Collection"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative></narrative><displayx>330</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9459f512-1cb5-4884-b551-4dcace90d77f" name="Field Name" type="Data"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c7b9c9ed-85d9-4449-a150-5182797dc6f3" name="Set Field" type="Code"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll" expr="[Collection]" /><input type="text" name="FieldName" expr="[Field Name]" /><input type="number" name="RowIndex" expr="[Row Index]" /><input type="text" name="New Value" expr="[New Value]" /></inputs><outputs><output type="collection" name="Updated Collection" stage="Updated Collection" /></outputs><onsuccess>2be33601-0c29-45c7-bc7e-1a5a8d1c19b2</onsuccess><code><![CDATA[
If RowIndex < 0 OrElse Coll.Rows.Count <= RowIndex Then
	Throw New ApplicationException("The supplied row index falls outside of the valid range.")
End If

If Not Coll.Columns.Contains(FieldName) Then
   Throw New ApplicationException("The collection does not contain a field with the name '" & FieldName & "'")
End If

Coll.Rows(RowIndex)(FieldName) = New_Value

Updated_Collection = Coll]]></code></stage><stage stageid="2c198fde-25d6-4009-a434-256fd08044b1" name="New Value" type="Data"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative></narrative><displayx>390</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="532e300d-c8f5-4049-9b1e-490a9a85884c" name="Updated Collection" type="Collection"><subsheetid>05992810-1be4-4455-84e8-10579308ab87</subsheetid><narrative></narrative><displayx>195</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6164801d-51c0-428e-976d-23828f70767d" name="Collection Contains Field" type="SubSheetInfo"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative>Tests a collection to see whether it contains a specific field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1ed16edd-07a7-459b-abc4-c29fc16117eb" name="Start" type="Start"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="Whether the collection contains the field will have been determined." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection to check." stage="Input Collection" /><input type="text" name="Field" narrative="The field to see if the collection has." stage="Field" /></inputs><onsuccess>a76de6a5-ad0f-42b0-8cea-1cc827be1d45</onsuccess></stage><stage stageid="15854162-6197-477a-873b-73c9b453d0d3" name="End" type="End"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>495</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="True if the collection contains the field." stage="Success" /><output type="text" name="Error Message" narrative="Unused" stage="Error Message" /></outputs></stage><stage stageid="a76de6a5-ad0f-42b0-8cea-1cc827be1d45" name="Get Collection Fields" type="SubSheet"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Collection Fields" stage="Field Names" /></outputs><onsuccess>73ed00ea-d816-4343-8fe2-09924b85491f</onsuccess><processid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</processid></stage><stage stageid="09779833-6862-44cb-a355-04cb35350208" name="Input Collection" type="Collection"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-120</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1343f537-262d-4113-8953-31173a54fdf9" name="Field" type="Data"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative></narrative><displayx>285</displayx><displayy>-120</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73ed00ea-d816-4343-8fe2-09924b85491f" name="Loop Start Collection Fields" type="LoopStart"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>11a28026-8164-4066-97bb-6f7cc6a3f6de</onsuccess><groupid>53f9e518-2d0e-4a03-a2ac-5ffa45e0ab8a</groupid><looptype>ForEach</looptype><loopdata>Field Names</loopdata></stage><stage stageid="c2b21dab-e784-43a7-b09a-19e8bf2d5672" name="Loop End Collection Fields" type="LoopEnd"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>bb6a782a-c599-42f2-8bba-f8c298f65be6</onsuccess><groupid>53f9e518-2d0e-4a03-a2ac-5ffa45e0ab8a</groupid></stage><stage stageid="04208d31-4ee8-45a6-af69-2dd8140cc92a" name="Field Names" type="Collection"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative></narrative><displayx>150</displayx><displayy>-45</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Field Name" type="text" /><field name="Data Type" type="text" /></collectioninfo></stage><stage stageid="d010b7fb-5d33-4636-bea8-2195b0f22738" name="Success" type="Data"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative></narrative><displayx>195</displayx><displayy>210</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="ac2d5cc5-ddee-4785-bf6a-410b0e478722" name="Error Message" type="Data"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><narrative></narrative><displayx>300</displayx><displayy>210</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="11a28026-8164-4066-97bb-6f7cc6a3f6de" name="Match?" type="Decision"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Field Names.Field Name] = Trim([Field])" /><ontrue>95c39a4f-2e55-45cb-a622-5cdec6b2d75b</ontrue><onfalse>c2b21dab-e784-43a7-b09a-19e8bf2d5672</onfalse></stage><stage stageid="6bd78de4-b21e-4741-af66-a88c72496d0f" name="anchor2" type="Anchor"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>255</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>bb6a782a-c599-42f2-8bba-f8c298f65be6</onsuccess></stage><stage stageid="95c39a4f-2e55-45cb-a622-5cdec6b2d75b" name="Set Success" type="Calculation"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>105</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6bd78de4-b21e-4741-af66-a88c72496d0f</onsuccess><calculation expression="True" stage="Success" /></stage><stage stageid="e6748536-1050-482b-86e6-cd57cce3bc6d" name="Copy Rows" type="SubSheetInfo"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative>Copies the rows of the given collection into a new collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="46e0886c-ea0a-4778-ad1e-9b7878e04a43" name="Append Rows to Collection" type="SubSheetInfo"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative>Combines two collections into one, provided they share the same set of fields</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d3ec306e-f0c9-4bbc-a4da-a38b21969f5c" name="Reverse Collection" type="SubSheetInfo"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><narrative>Reverses the order of the rows in the collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="98b20289-3b73-4776-9912-d679291e392e" name="Reverse Collection" type="Code"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="CollectionIn" expr="[Collection In]" /></inputs><outputs><output type="collection" name="CollectionOut" stage="Collection Out" /></outputs><onsuccess>661b2b7b-7862-4db1-b71c-747437b534da</onsuccess><code><![CDATA[If CollectionIn.Columns.Count = 0 Then Throw new ApplicationException("Zero columns in collection")

CollectionOut = new DataTable
For Each C As DataColumn In CollectionIn.Columns
	CollectionOut.Columns.Add(C.ColumnName, C.DataType)
Next

For I As integer = CollectionIn.Rows.Count - 1 To 0 Step -1
	Dim Objs(CollectionIn.Columns.Count - 1) As Object
	For J As integer = 0 to CollectionIn.Columns.Count - 1
		Objs(J) = collectionIn.Rows(I)(J)
	Next
	CollectionOut.Rows.Add(Objs)
Next]]></code></stage><stage stageid="48fd9b49-12a4-490d-8741-7cb0e6de6ac2" name="Collection In" type="Collection"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><initialvalue><row><field name="CIS" type="number" value="1" /><field name="Sort Code" type="text" value="123456" /><field name="Account Number" type="text" value="12345678" /><field name="Balance" type="number" value="1" /><field name="Cancelled Items" type="text" value="" /></row><row><field name="CIS" type="number" value="3" /><field name="Sort Code" type="text" value="223456" /><field name="Account Number" type="text" value="22345678" /><field name="Balance" type="number" value="2" /><field name="Cancelled Items" type="text" value="" /></row><row><field name="CIS" type="number" value="2" /><field name="Sort Code" type="text" value="323456" /><field name="Account Number" type="text" value="32345678" /><field name="Balance" type="number" value="3" /><field name="Cancelled Items" type="text" value="" /></row><row><field name="CIS" type="number" value="5" /><field name="Sort Code" type="text" value="423456" /><field name="Account Number" type="text" value="42345678" /><field name="Balance" type="number" value="4" /><field name="Cancelled Items" type="text" value="" /></row><row><field name="CIS" type="number" value="6" /><field name="Sort Code" type="text" value="523456" /><field name="Account Number" type="text" value="52345678" /><field name="Balance" type="number" value="5" /><field name="Cancelled Items" type="text" value="" /></row><row><field name="CIS" type="number" value="4" /><field name="Sort Code" type="text" value="623456" /><field name="Account Number" type="text" value="62345678" /><field name="Balance" type="number" value="6" /><field name="Cancelled Items" type="text" value="" /></row></initialvalue></stage><stage stageid="862d18c4-1bd0-4542-b3e2-8baf8a977af8" name="Start" type="Start"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have been sorted." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to be reversed." stage="Collection In" /></inputs><onsuccess>98b20289-3b73-4776-9912-d679291e392e</onsuccess></stage><stage stageid="661b2b7b-7862-4db1-b71c-747437b534da" name="End" type="End"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Reversed Collection" narrative="The reversed collection." stage="Collection Out" /></outputs></stage><stage stageid="1965b145-70ec-4ee0-a936-3c32f57e587e" name="Collection Out" type="Collection"><subsheetid>ffab882f-007c-48a5-8f84-8f5f1bfd4d6a</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ca7dbfca-b97f-43d4-9601-6fa4d4eacc4b" name="Rename Collection Fields" type="SubSheetInfo"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative>Renames the fields of a collection based on the fields of a given name mapping collection.</narrative><displayx>-60</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="be8b9084-5d06-424d-8086-89d565e39887" name="Start" type="Start"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection fields will have been renamed." /></postconditions><narrative></narrative><displayx>105</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" narrative="The main collection, whose headers are to be modified" stage="Main Collection" /><input type="collection" name="New Headers" narrative="A collection of new headers. This must be a one-row collection matching the fields of the first. The first row will contain the new field names under the corresponding field names" stage="New Headers" /></inputs><onsuccess>2dfc16b3-737a-4ff7-9843-9e66c78b23d4</onsuccess></stage><stage stageid="7eadbd5a-bba1-4128-ac2a-9bbe81d6ec77" name="End" type="End"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Amended Collection" stage="Amended Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs></stage><stage stageid="5c64c0b3-6819-410a-be71-587501d42504" name="New Headers" type="Collection"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><initialvalue><row><field name="Column 1" type="text" value="Name" /><field name="Column 2" type="text" value="Age" /></row></initialvalue></stage><stage stageid="2dfc16b3-737a-4ff7-9843-9e66c78b23d4" name="Rename Headers" type="Code"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" expr="[Main Collection]" /><input type="collection" name="New Headers" expr="[New Headers]" /></inputs><outputs><output type="collection" name="Amended Collection" stage="Amended Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs><onsuccess>7eadbd5a-bba1-4128-ac2a-9bbe81d6ec77</onsuccess><code><![CDATA[If Main_Collection IsNot Nothing AndAlso New_Headers IsNot Nothing Then
	If Main_Collection.Columns.Count = New_Headers.Columns.count Then
		For Each Col1 As DataColumn In Main_Collection.Columns
			If Not New_Headers.Columns.Contains(Col1.ColumnName) Then
				Success = False
				Error_Message = "New Headers collection does not contain the field '" & Col1.ColumnName & "' found in the Main Collection"
				Exit Sub
			End If
		Next

		'We can now assume that fields match
		'and start copying rows
		For Each C As DataColumn In Main_Collection.Columns
			Dim NewName As String = Cstr(New_Headers.Rows(0)(C.ColumnName))
			If String.IsNullOrEmpty(NewName) Then
				Throw New ApplicationException("Blank field names are not acceptable")
			Else
				C.ColumnName = Trim(NewName)
			End If
		Next

		Main_Collection.AcceptChanges()
		Amended_Collection = Main_Collection
		Success = True
	Else
		Success = False
		Error_Message = "Collection field definitions do not match - the number of columns in each is different."
	End If
Else
	Success = False
	Error_Message = "Neither Collection may be null"
End If]]></code></stage><stage stageid="73981b01-1a93-4c6e-a35f-fa6c194f63ec" name="Success" type="Data"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative></narrative><displayx>240</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73dcc958-035e-40f7-ab25-a8f22d06bf4f" name="Error Message" type="Data"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative></narrative><displayx>180</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0af7f983-37fd-47c4-971a-5c0ca70b60c4" name="Main Collection" type="Collection"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative></narrative><displayx>210</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><initialvalue><row><field name="Column 1" type="text" value="asdf" /><field name="Column 2" type="text" value="34" /></row></initialvalue></stage><stage stageid="e86fffbd-3537-4ed9-9e32-20c8f55b6cb6" name="Amended Collection" type="Collection"><subsheetid>bcde64eb-f856-4440-a6c0-d83f40f0cf4b</subsheetid><narrative></narrative><displayx>360</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6b6aa002-ceed-4ea9-ab37-e3cc338e349c" name="Collection Contains Value" type="SubSheetInfo"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative>Searches for the existence of a value or a regular expression in a specified column in a collection. This will return true and, if a regular expression was provided, the groups defined in that regex for the first matched value it finds in the collection.</narrative><displayx>-255</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="29ece439-17ef-4972-aa97-b373f2d68616" name="Start" type="Start"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><preconditions><condition narrative="A collection exists with the specified column name which may or may not contain a particular value" /><condition narrative="The collection being searched has no date or time columns (A code stage restriction)" /><condition narrative="" /><condition narrative="" /></preconditions><postconditions><condition narrative="No change" /></postconditions><narrative>Note that if neither 'Exact Value' nor 'Regex' are supplied, this will always return FALSE / ie. not found. If a match is found, groups will return all of the groups specified in the regular expression when applied to the value found.</narrative><displayx>-30</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="Required : The collection to search" stage="Collection" /><input type="text" name="Column Name" narrative="Required : The name of the column to search" stage="Column Name" /><input type="text" name="Exact Value" narrative="Optional : The exact value to search for - this is case insensitive" stage="Exact Value" /><input type="text" name="Regex" narrative="Optional : The regular expression to search for - this is case sensitive unless specified otherwise in the regular expression using &quot;(?i)&quot;" stage="Regex" /></inputs><onsuccess>aa1a4d89-5218-4bbe-a743-0d3484968cb6</onsuccess></stage><stage stageid="ebc6a036-6449-4acd-ac3c-bf1c0cdb652a" name="End" type="End"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Contains Search Term" narrative="Flag indicating if the collection found the given search term or not" stage="Contains Search Term" /><output type="collection" name="Groups" narrative="The groups defined in the regular expression when it is applied to the found term" stage="Groups" /></outputs></stage><stage stageid="63287049-53dd-4e10-b6fa-809c255a8f63" name="Collection" type="Collection"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="14def48d-230f-4041-99c7-0af7c0dd5e0f" name="Column Name" type="Data"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="965f0a82-f3be-4fcf-b43d-33b5a31b45d1" name="Exact Value" type="Data"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>60</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f2df8ab8-a7dc-408c-962c-efe2dd44d403" name="Regex" type="Data"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>90</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6c87975d-a017-4b35-923d-19816f41b5b3" name="Contains Search Term" type="Data"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="f7c0f14b-16b5-4e13-b3e9-71fd7bf59990" name="Groups" type="Collection"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Group" type="text" /></collectioninfo></stage><stage stageid="ca62b1b4-f73d-422a-b21a-ac4cfcc71041" name="Note2" type="Note"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-330</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="86ee4f07-c603-44e1-b307-e53cd7d9eff4" name="Note2" type="Note"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-180</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a408f364-ecb4-4548-9556-57f4a26f3ada" name="Both Search Strings Empty?" type="Decision"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Len([Exact Value]) = 0 AND Len ([Regex]) = 0" /><ontrue>612f50dc-0fcc-4765-800b-e65e5bf3861f</ontrue><onfalse>7cdc88ed-891c-4f88-a51d-2da37bd56d4d</onfalse></stage><stage stageid="aa1a4d89-5218-4bbe-a743-0d3484968cb6" name="Trim Search Strings" type="MultipleCalculation"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>a408f364-ecb4-4548-9556-57f4a26f3ada</onsuccess><steps><calculation expression="Trim([Exact Value])" stage="Exact Value" /><calculation expression="Trim([Regex])" stage="Regex" /></steps></stage><stage stageid="612f50dc-0fcc-4765-800b-e65e5bf3861f" name="anchor3" type="Anchor"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>7e121ceb-3f72-4655-8e21-38d3e5be7cec</onsuccess></stage><stage stageid="7e121ceb-3f72-4655-8e21-38d3e5be7cec" name="anchor4" type="Anchor"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>90</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ebc6a036-6449-4acd-ac3c-bf1c0cdb652a</onsuccess></stage><stage stageid="7cdc88ed-891c-4f88-a51d-2da37bd56d4d" name="Search Collection" type="Code"><subsheetid>5b8e4ed2-8ba9-4b0f-966e-a0e392f44e7a</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="coll" expr="[Collection]" /><input type="text" name="colname" expr="[Column Name]" /><input type="text" name="exactVal" expr="[Exact Value]" /><input type="text" name="regexVal" expr="[Regex]" /></inputs><outputs><output type="flag" name="found" stage="Contains Search Term" /><output type="collection" name="groups" stage="Groups" /></outputs><onsuccess>ebc6a036-6449-4acd-ac3c-bf1c0cdb652a</onsuccess><code><![CDATA[If Not Coll.Columns.Contains(colname) Then
  Throw New ApplicationException(String.Format( _
   "The collection does not contain a field " & _
   "with the name '{0}'", colname))
End If

Dim rx as Regex
If Not String.IsNullOrEmpty(exactVal) Then
  rx = New Regex("^" & Regex.Escape(exactVal) & "$", RegexOptions.IgnoreCase)
Else
  ' If ignore case is required it can be inlined using "(?i)..rest of search"
  rx = New Regex(regexVal)
End If

' Initialise output params
found = False
groups = New DataTable()
groups.Columns.Add("Group", GetType(String))

For Each row as DataRow in coll.Rows

  Dim val as String = CStr(row(colname))
  Dim m as Match = rx.Match(Trim(val))
  If m.Success Then
    found = True
    For i as Integer = 1 to m.Groups.Count-1
      groups.Rows.Add(New Object() {m.Groups(i).Value})
    Next
    Return
  End If

Next]]></code></stage><stage stageid="365e481a-8567-48cf-babf-40039e151df7" name="Delete Column" type="SubSheetInfo"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative>Deletes a field from a collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4421e0d9-6181-4872-aa85-8ad310427d30" name="Start" type="Start"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collections field will have been removed." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection from which you want to delete a column from" stage="Input Collection" /><input type="text" name="Column Name" narrative="The column number to delete" stage="Column Name" /></inputs><onsuccess>000581d7-9978-4295-826f-a20472874878</onsuccess></stage><stage stageid="d0f8de6d-03ac-4a92-8658-0998d1849bdf" name="End" type="End"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="A collection with a column removed" stage="Output Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Message" /></outputs></stage><stage stageid="000581d7-9978-4295-826f-a20472874878" name="Remove Column" type="Code"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="BP Collection In" expr="[Input Collection]" /><input type="text" name="Column Name" expr="[Column Name]" /></inputs><outputs><output type="collection" name="BP Collection Out" stage="Output Collection" /><output type="text" name="Error Message" stage="Message" /><output type="flag" name="Success" stage="Success" /></outputs><onsuccess>d0f8de6d-03ac-4a92-8658-0998d1849bdf</onsuccess><code><![CDATA[BP_Collection_Out = BP_Collection_In
BP_Collection_Out.Columns.Remove(Column_Name)
]]></code></stage><stage stageid="140b41b2-3138-4b5d-b5f3-4bddff6db48f" name="Input Collection" type="Collection"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1ae60809-2da8-468d-8d88-e605b185530b" name="Output Collection" type="Collection"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative></narrative><displayx>120</displayx><displayy>90</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="787dae64-5d33-4783-84ff-db2365c12e31" name="Message" type="Data"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a3216578-e35c-4bf0-84db-80b9d3fe07e3" name="Success" type="Data"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="714ec185-fd95-4265-88e6-54eb452242b3" name="Column Name" type="Data"><subsheetid>df662579-558c-4cc9-88df-8c680b67b41d</subsheetid><narrative></narrative><displayx>210</displayx><displayy>-105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="25782854-2b5d-4f7d-a1f4-671555060370" name="Remove Null Rows" type="SubSheetInfo"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative>Deletes rows in which a given key field is blank.</narrative><displayx>-180</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7b68a8ca-8280-464d-acac-807f219d226e" name="Set Column Names From First Row" type="SubSheetInfo"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><narrative>If you have a collection with the column names all in the first row, this will set the column names to the values in that row and then detete the first row.
Handy for collections read using Get Table</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="966db302-1751-4a8a-bbbf-cbfc8ff28563" name="Start" type="Start"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>5732b352-4376-4727-b423-13df1e00f900</onsuccess></stage><stage stageid="80cc4a73-fa55-4504-bf38-941a29fd4499" name="End" type="End"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The amended collection" stage="Output Collection" /></outputs></stage><stage stageid="5732b352-4376-4727-b423-13df1e00f900" name="Set Column Name" type="Code"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>1129bf72-f0d4-4c3a-8823-68de39f5138b</onsuccess><code><![CDATA[
'Input_Collection.Columns(3).ColumnName="NewColumnName"
'Output_Collection = Input_Collection

Dim iThisColumn as integer = -1
For Each Column As DataColumn In Input_Collection.Columns
   iThisColumn +=1
   Column.ColumnName=CStr(Input_Collection.Rows.Item(0).Item(iThisColumn))
Next
Output_Collection = Input_Collection

'If RowIndex < 0 OrElse Coll.Rows.Count <= RowIndex Then
'	Throw New ApplicationException("The supplied row index falls outside of the valid range.")
'End If

'If Not Coll.Columns.Contains(FieldName) Then
'   Throw New ApplicationException("The collection does not contain a field with the name '" & FieldName & "'")
'End If

'Value_Read = CStr(Coll.Rows(RowIndex)(FieldName))]]></code></stage><stage stageid="83beff52-ce08-4f4c-acdd-39a43fce3528" name="Input Collection" type="Collection"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="0735b980-7ff2-49c5-a67b-41a6444db630" name="Output Collection" type="Collection"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><narrative></narrative><displayx>120</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="299628df-bec6-4f77-8b4a-c6bc38824e1c" name="Remove First Row" type="Action"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative>First row was actually the header row, can now be deleted</narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Output Collection&quot;" /></inputs><onsuccess>80cc4a73-fa55-4504-bf38-941a29fd4499</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove Row" /></stage><stage stageid="1129bf72-f0d4-4c3a-8823-68de39f5138b" name="Output Collection" type="LoopStart"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>299628df-bec6-4f77-8b4a-c6bc38824e1c</onsuccess><groupid>265b5de8-c5fa-44dc-bcd0-64db001c133a</groupid><looptype>ForEach</looptype><loopdata>Output Collection</loopdata></stage><stage stageid="35a49bfb-e611-4681-b332-cadbcfa74fc3" name="Output Collection" type="LoopEnd"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>-60</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d0febcf9-b538-4995-85c1-02dddff5fb51</onsuccess><groupid>265b5de8-c5fa-44dc-bcd0-64db001c133a</groupid></stage><stage stageid="d0febcf9-b538-4995-85c1-02dddff5fb51" name="anchor1" type="Anchor"><subsheetid>b8e3b975-d485-49a3-b962-864d13a96e05</subsheetid><loginhibit /><narrative></narrative><displayx>-60</displayx><displayy>120</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>80cc4a73-fa55-4504-bf38-941a29fd4499</onsuccess></stage><stage stageid="7b3c5ed5-f585-4240-a2ab-8cb996684c24" name="Set Column Names From Expected Collection" type="SubSheetInfo"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><narrative>Renames the fields of a collection to those of a collection containing expected field names.</narrative><displayx>-180</displayx><displayy>-210</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ae4a6ef5-a22c-4292-8471-eb02cdd4b1cf" name="End" type="End"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The collection with the renamed column" stage="Output Collection" /></outputs></stage><stage stageid="130f8b77-3ec8-46c9-8826-e401399e4c92" name="Rename Column" type="Code"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /><input type="collection" name="Expected Fields/Columns" expr="[Expected Fields/Columns]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>ae4a6ef5-a22c-4292-8471-eb02cdd4b1cf</onsuccess><code><![CDATA[Dim iTotalColumns as integer = Expected_Fields_Columns.Rows.Count-1
Dim iThisColumn as integer = -1
For Each Column As DataColumn In Input_Collection.Columns
   If iThisColumn>=iTotalColumns Then Exit For
   iThisColumn +=1 
   Column.ColumnName=CStr(Expected_Fields_Columns.Rows.Item(iThisColumn).Item(0))
Next
Output_Collection = Input_Collection]]></code></stage><stage stageid="9e32e67d-d7f9-46b2-8df2-6fca9a395352" name="Input Collection" type="Collection"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c66d8d30-cef9-4cab-8ee8-2acb512a3129" name="Start" type="Start"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection fields will have been renamed." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /><input type="collection" name="Expected Fields/Columns" narrative="The expected column names" stage="Expected Fields/Columns" /></inputs><onsuccess>130f8b77-3ec8-46c9-8826-e401399e4c92</onsuccess></stage><stage stageid="c865f7af-a9f9-4fb9-88da-e04e43b0bac8" name="Note1" type="Note"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-180</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="c29dd25d-3cf7-4435-ba56-6f735329a71a" name="Output Collection" type="Collection"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="235be3b3-8a37-4bac-b740-50cfcd6da05f" name="Note1" type="Note"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-180</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="688d2271-65ed-4be7-84b1-cbfe018c6777" name="Expected Fields/Columns" type="Collection"><subsheetid>87541f35-d834-4d99-8fd3-16ec994a9990</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /><collectioninfo><field name="Column Name" type="text" /></collectioninfo></stage><stage stageid="df1f7e11-20da-4f67-a68c-bc7c03be861a" name="Fill Blanks" type="SubSheetInfo"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><narrative>Fills a collection that has empty values with empty text.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7908b17c-920d-4114-9fa0-cd4f161c5185" name="Start" type="Start"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have its empty values filled with empty text." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Blanks" narrative="A collection with blank text fields" stage="Blanks" /></inputs><onsuccess>06913dc6-a17f-4d64-965d-7cb7642f486f</onsuccess></stage><stage stageid="544cc959-75ad-4b6c-a150-ce414ae50424" name="End" type="End"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="No Blanks" narrative="The collection with empty string instead of blanks" stage="No Blanks" /></outputs></stage><stage stageid="34873761-d9a4-4a71-9c63-993645ca4e22" name="Blanks" type="Collection"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5cfec416-7db4-4734-9a1f-76d62db9bbd9" name="No Blanks" type="Collection"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="06913dc6-a17f-4d64-965d-7cb7642f486f" name="Fill Blanks" type="Code"><subsheetid>d1eee74f-1582-4c3e-96c8-b94f1535d7e1</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Blanks" expr="[Blanks]" /></inputs><outputs><output type="collection" name="No Blanks" stage="No Blanks" /></outputs><onsuccess>544cc959-75ad-4b6c-a150-ce414ae50424</onsuccess><code><![CDATA[try
  for each dr as datarow in blanks.rows
    for each c as datacolumn in blanks.columns
      if isdbnull(dr(c.columnname)) then
        dr(c.columnname) = ""
      end if
    next
  next
  no_blanks = blanks
catch e as exception

end try]]></code></stage><stage stageid="c491f60e-4aa7-4abb-a203-5a78c0b64469" name="End" type="End"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The given input collection with all the null rows removed" stage="Output Collection" /></outputs></stage><stage stageid="c8499a69-da78-40b1-9e30-3b2b66b78a63" name="Start" type="Start"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The rows with blank keys will have been deleted." /><condition narrative="" /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection from which you want null rows to be removed" stage="Input Collection" /><input type="text" name="Key Field" narrative="The key field to check, if blank the row will be deleted" stage="Key Field" /></inputs><onsuccess>85077240-20a2-46ad-81ba-a1eca720ae81</onsuccess></stage><stage stageid="e14452d8-589d-478a-ab1b-309897b8560b" name="End" type="End"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The given input collection with all the null rows removed" stage="Output Collection" /></outputs></stage><stage stageid="13091eb3-458e-46d2-a20e-59eb5eb5d748" name="Input Collection" type="Collection"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6ab2855e-0511-49ff-ac26-c731dbf8c432" name="Output Collection" type="Collection"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>120</displayx><displayy>90</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cab44f8f-583a-4529-911c-392030a2dee3" name="Message" type="Data"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e1203642-ce03-48bd-ba00-aad2a0dcde1e" name="Success" type="Data"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1478eda2-b43b-4609-aef4-ff3ad3c2a708" name="Key Field" type="Data"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>225</displayx><displayy>-105</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="85077240-20a2-46ad-81ba-a1eca720ae81" name="Remove Null rows from collection" type="Code"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><loginhibit /><narrative>can't loop through the core customer details table collection as some of the rows are NULL.</narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="CCD Table In" expr="[Input Collection]" /><input type="text" name="Key Field" expr="[Key Field]" /></inputs><outputs><output type="collection" name="CCD Table Out" stage="Output Collection" /><output type="text" name="Error Message" stage="Message" /><output type="flag" name="Success" stage="Success" /></outputs><onsuccess>2e050fc0-fed0-49b4-bafc-a33a0aee5ad9</onsuccess><code><![CDATA[Try
	For Each row As DataRow in CCD_Table_In.Select( _
	 String.Format("[{0}] is null or trim([{0}]) = ''", Key_Field))
		row.Delete()
	Next

	CCD_Table_Out = CCD_Table_In
	Success = True

Catch ex as Exception
	Error_Message = ex.ToString()
	Success = False

End Try

]]></code></stage><stage stageid="9e92c3e9-666f-47a3-b5a4-712191368127" name="Remove dots from headers" type="SubSheetInfo"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><narrative>Collections with dots in the field names cannot be properly indexed so this functinon renames the headers so that the fields contain no dots.</narrative><displayx>-165</displayx><displayy>-195</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9e9143b5-5aa7-475d-a944-466bfbc2c71d" name="Rename Column1" type="Code"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>ce865562-7be4-4739-95c5-3b5e05d7901f</onsuccess><code><![CDATA[For Each Column As DataColumn In Input_Collection.Columns
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName,".","")
Next
Output_Collection = Input_Collection]]></code></stage><stage stageid="ce865562-7be4-4739-95c5-3b5e05d7901f" name="End" type="End"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The collection with the renamed column" stage="Output Collection" /></outputs></stage><stage stageid="c2200054-2838-45a0-a8b2-c1da235391b0" name="Input Collection" type="Collection"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c865c672-39f2-4b5d-b96c-f44c5f3b9a89" name="Start" type="Start"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have fields with no dots." /></postconditions><narrative></narrative><displayx>0</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>9e9143b5-5aa7-475d-a944-466bfbc2c71d</onsuccess></stage><stage stageid="02864eb4-432c-4b37-9199-c28dd7fe654b" name="Note1" type="Note"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-195</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="99cb4759-fd39-4084-a262-e2ac589fdc28" name="Output Collection" type="Collection"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c1388967-ebc6-462c-bad7-66359084fab0" name="Note1" type="Note"><subsheetid>eb03a051-75a8-4093-a383-6c6fecfbb736</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4e265aee-0021-418d-8655-61d995e170a0" name="Append Field (Text)" type="SubSheetInfo"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><narrative>Appends a field to a collection and allows you to provide a default value as text fot the field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="c8bd0a3b-3343-43fd-bef7-1414593f62b6" name="Field Name" type="Data"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ddaf3d76-462d-41ac-8cdd-92050ea01b79" name="Append Text" type="Code"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="text" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>072e40e3-3858-4528-aa1b-7b4cfb7861f9</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.String"))
End If

For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
Next

New_Collection = Collection
]]></code></stage><stage stageid="7c2f4495-6f2c-4dc5-845c-58f3036c5ec9" name="Collection Out" type="Collection"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="8493982d-24c5-4d6b-96c0-060ed614f8c3" name="Collection In" type="Collection"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6542d3cd-7831-4ebb-93dc-09b64ff85bbf" name="Value" type="Data"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6c1475ad-07b2-4993-abb1-4060046ce8eb" name="Start" type="Start"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have a new field appended to it." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="text" name="Value" narrative="The value to be put in the new field." stage="Value" /></inputs><onsuccess>ddaf3d76-462d-41ac-8cdd-92050ea01b79</onsuccess></stage><stage stageid="072e40e3-3858-4528-aa1b-7b4cfb7861f9" name="End" type="End"><subsheetid>a474299b-5c1c-4873-a3af-4dd0d3bd03ff</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="4c0d7072-e36c-465b-89f0-fbe7e21e95fb" name="Append Field (Number)" type="SubSheetInfo"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><narrative>Appends a field to a collection and allows you to provide a default number value for the field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="433e0a45-d9b6-48e5-b62f-67815cc1461a" name="Start" type="Start"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have the new field appended to it." /></postconditions><narrative></narrative><displayx>30</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="number" name="Value" narrative="The value to be put in the new field." stage="Value" /></inputs><onsuccess>560df05e-a20c-4c85-addb-accc35d19f0e</onsuccess></stage><stage stageid="5dc78a95-36a2-4324-a366-ccd5f941ea7b" name="End" type="End"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="560df05e-a20c-4c85-addb-accc35d19f0e" name="Append Number" type="Code"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="number" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>5dc78a95-36a2-4324-a366-ccd5f941ea7b</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.Decimal"))
End If

For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
Next

New_Collection = Collection
]]></code></stage><stage stageid="a8f65fc6-9524-4ba5-ab7c-4bf16b825bb8" name="Collection Out" type="Collection"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1265e994-416c-4b2d-ab0c-c81e1288f072" name="Field Name" type="Data"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4ac81567-c224-4270-a0ef-e57562e06fb5" name="Collection In" type="Collection"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f9a670a2-2e34-4e79-a184-369ddc70c75e" name="Value" type="Data"><subsheetid>65451129-b7a2-4c2f-a12d-9086bd314f53</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5979fe4e-6f4d-4683-8d7f-bb932ec88a2e" name="Rename Field" type="SubSheetInfo"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><narrative>Renames a field within a collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5030c234-e021-4ff1-b9ea-751e186a63a8" name="Start" type="Start"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collections field will be renamed." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to rename a field in." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the existing field to rename." stage="Field Name" /><input type="text" name="New Name" narrative="The new name for the field." stage="New Name" /></inputs><onsuccess>278ed0f4-d7d0-4ca7-908e-55569a965852</onsuccess></stage><stage stageid="404be5b2-7ad7-429a-9e8b-b6a561112f47" name="End" type="End"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with field renamed." stage="Collection Out" /></outputs></stage><stage stageid="67c49160-5821-48b0-82fd-371ecbaea386" name="Collection In" type="Collection"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f0ef8f48-7f60-47fc-89b2-3aa04ef39792" name="Field Name" type="Data"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8c1db25c-d091-4900-8b9e-529d60df0f8f" name="Collection Out" type="Collection"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="278ed0f4-d7d0-4ca7-908e-55569a965852" name="Rename" type="Code"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /><input type="text" name="Field_Name" expr="[Field Name]" /><input type="text" name="New Name" expr="[New Name]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>404be5b2-7ad7-429a-9e8b-b6a561112f47</onsuccess><code><![CDATA[
Collection_Out = Collection_In.Copy

For Each c As DataColumn in Collection_Out.Columns
	If c.ColumnName = Field_Name Then
		c.ColumnName = New_Name
		Exit For
	End If
Next
]]></code></stage><stage stageid="b2e64d6d-9ac8-43b9-aeed-e58e65d8067c" name="New Name" type="Data"><subsheetid>ccc0c027-8c9f-41f6-9ba6-af44eac6a9a9</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><alwaysinit /></stage><stage stageid="c935b0c8-a0cb-4251-9e63-af4ed27f9a91" name="Delete Field" type="SubSheetInfo"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><narrative>Deletes a field from a collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a7662efd-3d51-4d9a-adbc-1a2e626613e5" name="Start" type="Start"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collections field will have been removed." /></postconditions><narrative></narrative><displayx>30</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to delete the field from." stage="Collection In" /><input type="text" name="Field Name" narrative="The field to delete." stage="Field Name" /></inputs><onsuccess>b52dad46-ca6d-4860-82c7-f1d9320f66bc</onsuccess></stage><stage stageid="4e6ae3ea-d232-4ff3-b93b-ab90f6e93c1b" name="End" type="End"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with the field removed." stage="Collection Out" /></outputs></stage><stage stageid="4eb487df-f7e9-4146-a35f-e5e7c6461d01" name="Collection In" type="Collection"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="719f7d25-ec64-43bd-9466-c822213aa069" name="Field Name" type="Data"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0b32e1ce-deb0-4107-ac7c-c4af81ceedaf" name="Collection Out" type="Collection"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="b52dad46-ca6d-4860-82c7-f1d9320f66bc" name="Delete Column1" type="Code"><subsheetid>1d7b6202-d743-4485-9101-839f4651c406</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /><input type="text" name="Field_Name" expr="[Field Name]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>4e6ae3ea-d232-4ff3-b93b-ab90f6e93c1b</onsuccess><code><![CDATA[
Collection_Out = Collection_In.Copy

For Each c As DataColumn in Collection_Out.Columns
	If c.ColumnName = Field_Name Then
		Collection_Out.Columns.Remove(c)
		Exit For
	End If
Next
]]></code></stage><stage stageid="63e447be-76ae-4566-a7e9-ead3373b7fe6" name="Merge Collection" type="SubSheetInfo"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><narrative>Merges two collections with different structures (and where the field names across both collections are unique) and forms a single collection with a combination  of the two structures and associated data values.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d427bb44-b573-475a-aa7d-176f2803e033" name="Start" type="Start"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><loginhibit /><preconditions><condition narrative="The merge will fail if both collections contain any field names which are identical." /></preconditions><postconditions><condition narrative="The collections will have been merged." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection 1" narrative="The first collection to be merged." stage="Collection 1" /><input type="collection" name="Collection 2" narrative="The second collection to be merged." stage="Collection 2" /></inputs><onsuccess>6459a0e3-6f86-4efa-8b87-a9eb0b9a8460</onsuccess></stage><stage stageid="570e4b26-4aa8-48ac-b435-1ca8fe10f2cd" name="End" type="End"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection 3" narrative="The resulting merged collection." stage="Collection 3" /></outputs></stage><stage stageid="6459a0e3-6f86-4efa-8b87-a9eb0b9a8460" name="Merge" type="Code"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="c1" expr="[Collection 1]" /><input type="collection" name="c2" expr="[Collection 2]" /></inputs><outputs><output type="collection" name="c3" stage="Collection 3" /></outputs><onsuccess>570e4b26-4aa8-48ac-b435-1ca8fe10f2cd</onsuccess><code><![CDATA[
For Each c As DataColumn in c2.Columns
	c1.Columns.Add(c.ColumnName, c.DataType)
Next

For r As Integer = 0 To c1.Rows.Count - 1
	If r < c2.Rows.Count Then
		For Each c As DataColumn in c2.Columns
			c1.Rows(r)(c.ColumnName) = c2.Rows(r)(c.ColumnName)
		Next
	Else
		Exit For
	End If
Next

c3 = c1]]></code></stage><stage stageid="c325b6be-e358-4eab-8e9b-0b74a98490f3" name="Collection 1" type="Collection"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="61e7bd9a-18d4-475d-b131-95dc839d1518" name="Collection 2" type="Collection"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="3ff4ed5f-abbc-4668-9ebb-816c8f0884db" name="Collection 3" type="Collection"><subsheetid>cd8fefb9-4622-4ea7-8287-e64b86d7e513</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="741d8892-31ef-497b-a1ab-dca99ebd1f06" name="Split Collection" type="SubSheetInfo"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative>Splits a collection into two colllections containing the fields as defined by templates.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="61860248-5b8d-41de-8e28-092ca8b989e5" name="Split" type="Code"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="c1" expr="[Collection 1]" /><input type="collection" name="c2t" expr="[Collection 2 Template]" /><input type="collection" name="c3t" expr="[Collection 3 Template]" /></inputs><outputs><output type="collection" name="c2" stage="Collection 2" /><output type="collection" name="c3" stage="Collection 3" /></outputs><onsuccess>e08e6b18-850a-427c-9eba-5065c9c619dd</onsuccess><code><![CDATA[
c2 = New DataTable()
For Each c As DataColumn in c2t.Columns
	c2.Columns.Add(c.ColumnName, c.DataType)
Next

c3 = New DataTable()
For Each c As DataColumn in c3t.Columns
	c3.Columns.Add(c.ColumnName, c.DataType)
Next

Dim r2, r3 As DataRow
Dim bAdd2, bAdd3 As Boolean

For Each r1 As DataRow In c1.Rows

	r2 = c2.NewRow()
	r3 = c3.NewRow()
	bAdd2 = False
	bAdd3 = False

	For Each c As DataColumn In c1.Columns

		If c2.Columns.Contains(c.ColumnName) Then
			r2(c.ColumnName) = r1(c.ColumnName)
			bAdd2 = True
		ElseIf c3.Columns.Contains(c.ColumnName) Then
			r3(c.ColumnName) = r1(c.ColumnName)
			bAdd3 = True
		Else
			'Ignore this column		
		End If

	Next

	If bAdd2 Then
		c2.Rows.Add(r2)
	End If
	If bAdd3 Then
		c3.Rows.Add(r3)
	End If

Next]]></code></stage><stage stageid="d00a67c4-977f-49ab-ac41-225ebdb3ad8d" name="Collection 3 Template" type="Collection"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e2ce96fd-e590-46fa-a95d-effcca153782" name="Start" type="Start"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><preconditions><condition narrative="None." /><condition narrative="" /></preconditions><postconditions><condition narrative="Collections will be split." /><condition narrative="" /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection 1" stage="Collection 1" /><input type="collection" name="Collection 2 Template" stage="Collection 2 Template" /><input type="collection" name="Collection 3 Template" stage="Collection 3 Template" /></inputs><onsuccess>2c7d51f8-a340-4629-9d93-0526f6ed07cc</onsuccess></stage><stage stageid="e08e6b18-850a-427c-9eba-5065c9c619dd" name="End" type="End"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>300</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection 2" stage="Collection 2" /><output type="collection" name="Collection 3" stage="Collection 3" /></outputs></stage><stage stageid="67449419-0f6c-463b-bf1a-2d94b16c5be3" name="Collection 2" type="Collection"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>285</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="78bbd50d-b3cd-4066-80e3-d4cb236662b8" name="Collection 3" type="Collection"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>345</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2c7d51f8-a340-4629-9d93-0526f6ed07cc" name="Count Template 2 Rows" type="Action"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection 2 Template&quot;" /></inputs><outputs><output type="number" name="Count" narrative="The number of rows counted in the collection" stage="Row Count" /></outputs><onsuccess>2dbb3bb5-1526-4f1c-818d-aa4eb0acc677</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="5a6c9426-a48f-4861-b7fe-b020ea824cc5" name="Row Count" type="Data"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>165</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="2dbb3bb5-1526-4f1c-818d-aa4eb0acc677" name="Rows?" type="Decision"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Row Count]&gt;0" /><ontrue>17c0ae90-3784-40c5-816f-a0dfb4c97eab</ontrue><onfalse>6a04f2d4-b2f3-4afd-b837-ddaf0d40a9d5</onfalse></stage><stage stageid="17c0ae90-3784-40c5-816f-a0dfb4c97eab" name="Count Template 3 Rows" type="Action"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection 3 Template&quot;" /></inputs><outputs><output type="number" name="Count" narrative="The number of rows counted in the collection" stage="Row Count" /></outputs><onsuccess>525e699d-df7d-4c61-b5fd-0ae540b94a94</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="525e699d-df7d-4c61-b5fd-0ae540b94a94" name="Rows?" type="Decision"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Row Count]&gt;0" /><ontrue>01cbd6ed-952e-4ae8-8420-496581701364</ontrue><onfalse>c7cd5499-3bd2-49c8-a5e0-2c190b350abe</onfalse></stage><stage stageid="74cfea1c-af9f-4c0b-86aa-ac76097c3940" name="Collection 1" type="Collection"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2af4b9c5-d3f3-4ecc-9a3a-4b52f1cee481" name="Collection 2 Template" type="Collection"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c7cd5499-3bd2-49c8-a5e0-2c190b350abe" name="System Exception" type="Exception"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><narrative></narrative><displayx>105</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="&quot;Template collection cannot be empty&quot;" /></stage><stage stageid="6a04f2d4-b2f3-4afd-b837-ddaf0d40a9d5" name="anchor1" type="Anchor"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>0</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c7cd5499-3bd2-49c8-a5e0-2c190b350abe</onsuccess></stage><stage stageid="01cbd6ed-952e-4ae8-8420-496581701364" name="Count Data Rows" type="Action"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection 1&quot;" /></inputs><outputs><output type="number" name="Count" narrative="The number of rows counted in the collection" stage="Row Count" /></outputs><onsuccess>69ae2e43-547a-4cef-abc9-a57284282b82</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Count Rows" /></stage><stage stageid="69ae2e43-547a-4cef-abc9-a57284282b82" name="Rows?" type="Decision"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Row Count]&gt;0" /><ontrue>61860248-5b8d-41de-8e28-092ca8b989e5</ontrue><onfalse>4cffbd60-ffb8-4da0-aa50-3639bc6ff8ef</onfalse></stage><stage stageid="4cffbd60-ffb8-4da0-aa50-3639bc6ff8ef" name="Assign Outputs" type="Code"><subsheetid>76943739-36b9-46bc-8f95-e1b6342bc8a6</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>240</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="c2t" expr="[Collection 2 Template]" /><input type="collection" name="c3t" expr="[Collection 3 Template]" /></inputs><outputs><output type="collection" name="c2" stage="Collection 2" /><output type="collection" name="c3" stage="Collection 3" /></outputs><onsuccess>e08e6b18-850a-427c-9eba-5065c9c619dd</onsuccess><code><![CDATA[
c3 = c3t

c2 = c2t
]]></code></stage><stage stageid="8140b508-3840-4291-8122-7d9633f50e96" name="Collection In" type="Collection"><subsheetid>d8e5be7a-93aa-4322-99bf-00edea37bbc2</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cc074354-584f-4eba-ab53-2f96462259a0" name="Filter Collection" type="SubSheetInfo"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><narrative>Filters a collection using the given query.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4ee491db-1747-4f76-a969-78ebc05942c3" name="Start" type="Start"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will be filtered." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to filter." stage="Collection In" /><input type="text" name="Filter" narrative="The filter query." stage="Filter" /></inputs><onsuccess>0c063487-d7ee-42db-8059-92687b655e7d</onsuccess></stage><stage stageid="bda88544-a5a8-4bf6-9c9b-c645f76b7fed" name="End" type="End"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The filtered collection." stage="Collection Out" /></outputs></stage><stage stageid="0c063487-d7ee-42db-8059-92687b655e7d" name="Filter Collection1" type="Code"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /><input type="text" name="Select Condition" expr="[Filter]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>e94f0a38-9645-4799-bc80-e52c5ab6c1b5</onsuccess><code><![CDATA[Dim NewRow As DataRow

Collection_Out = Collection_In.Clone

For Each parentRow As DataRow In Collection_In.Select(Select_Condition)
	NewRow = Collection_Out.NewRow
	For Each c As DataColumn In NewRow.Table.Columns
		NewRow(c.ColumnName) = parentRow(c.ColumnName)
	Next
	Collection_Out.Rows.Add(NewRow)
Next

'NewRow = Nothing
Collection_In.Clear]]></code></stage><stage stageid="ab9df972-dcc0-4384-ae57-8f0207f70978" name="Collection Out" type="Collection"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="ee8d1e79-1554-41d5-9dec-d9cb9153d483" name="Collection In" type="Collection"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7b601fa9-308d-4e40-8366-62ebe909f792" name="Filter" type="Data"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6f60641e-4454-45d1-b678-62b0a6c6b784" name="Start" type="Start"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Start Row" narrative="The row index to start copying from. The index is from 0 to N-1 (where N is the total number of rows in the collection)." stage="Start Row" /><input type="number" name="Number of Rows to Copy" narrative="The number of rows to copy." stage="Number of Rows to Copy" /><input type="collection" name="Source Collection" narrative="The collection to copy." stage="Source Collection" /></inputs><onsuccess>25337bba-f357-42a8-bc61-876a9582d5d0</onsuccess></stage><stage stageid="002b5c58-ec2b-4e02-91e5-68fbeffe2b84" name="End" type="End"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The copied collection." stage="Output Collection" /></outputs></stage><stage stageid="1cd8f0a3-e382-4ad5-8948-7f0dc5cd17cd" name="Start Row" type="Data"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>60</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="abc78fcd-9654-47c6-9aa9-5cd8f505bd60" name="Number of Rows to Copy" type="Data"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>135</displayx><displayy>-120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="c3aa2821-e68a-4985-9fd7-e0330638a935" name="Source Collection" type="Collection"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-120</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="25337bba-f357-42a8-bc61-876a9582d5d0" name="Copy Rows1" type="Code"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Source Collection" expr="[Source Collection]" /><input type="number" name="Start Row" expr="[Start Row]" /><input type="number" name="Number of Rows to Copy" expr="[Number of Rows to Copy]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs><onsuccess>ff821741-f1ec-47ff-bd26-00c56a44a6c7</onsuccess><code><![CDATA[Try
	If Start_Row < 0 Then
		Throw New ApplicationException("Start Row must be at least zero.")
	End If
	Dim LastIndex As Integer = Source_Collection.Rows.Count -1
	If Start_Row > LastIndex Then
		Throw New ApplicationException("Start Row must not point beyond the end of the collection.")
	End If
	If Start_Row + Number_of_Rows_to_Copy -1 > LastIndex Then
		Throw New ApplicationException("The number of requested rows extends beyond the end of the collection (based on a start row of " & Start_Row.ToString() & ").")
	End If

	'Set up the new collection with columns
	Output_Collection = New DataTable()
	For J As Integer = 0 To Source_Collection.Columns.Count - 1
		Output_Collection.Columns.Add(Source_Collection.Columns(J).ColumnName, Source_Collection.Columns(J).DataType)
	Next

	'copy the requested rows one by one
	For I As integer = Start_Row To Start_Row + Number_of_Rows_to_Copy - 1
		Dim Values(Source_Collection.Columns.Count - 1) As Object
		For J As Integer = 0 To Source_Collection.Columns.Count - 1
			Values(J) = Source_Collection.Rows(I)(J)
		Next
		Output_collection.Rows.Add(Values)
	Next	
	
	Success = True
Catch Ex As Exception
	Success = False
	Error_Message = Ex.ToString()
End Try]]></code></stage><stage stageid="33698fa1-b8d8-467c-bb0d-b8e838d42c69" name="Output Collection" type="Collection"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="4f882206-da67-4422-ac01-a53a5d765354" name="Success" type="Data"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>60</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6551589d-b7f2-48b7-a867-b398647d0180" name="Error Message" type="Data"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>120</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ff821741-f1ec-47ff-bd26-00c56a44a6c7" name="Success?" type="Decision"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>002b5c58-ec2b-4e02-91e5-68fbeffe2b84</ontrue><onfalse>fd5c51f5-e900-44ce-a169-84565580d402</onfalse></stage><stage stageid="fd5c51f5-e900-44ce-a169-84565580d402" name="System Exception" type="Exception"><subsheetid>cdf2a7f1-a351-441a-8d36-bc92af66650a</subsheetid><narrative></narrative><displayx>90</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="[Error Message]" /></stage><stage stageid="c6165073-bfc9-495f-98e5-62a224f52226" name="Start" type="Start"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collections will be combined." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" narrative="The collection to append to." stage="Main Collection" /><input type="collection" name="Collection to Append" narrative="The collection to append." stage="Collection to Append" /></inputs><onsuccess>77e19cde-e0fa-40aa-8bea-05c4743275c2</onsuccess></stage><stage stageid="5d1a3d8d-2e99-49b5-9863-6a866e2e03dd" name="End" type="End"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Combined Collection" narrative="The combined collection." stage="Combined Collection" /></outputs></stage><stage stageid="e3a95b76-e1ba-4bf1-92c1-653ae937120a" name="Main Collection" type="Collection"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="320afdfe-675f-44a8-b563-5cf2cf3212d3" name="Collection to Append" type="Collection"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="77e19cde-e0fa-40aa-8bea-05c4743275c2" name="Combine Collections" type="Code"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" expr="[Main Collection]" /><input type="collection" name="Collection to Append" expr="[Collection to Append]" /></inputs><outputs><output type="collection" name="Combined Collection" stage="Combined Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs><onsuccess>35415fae-0f6d-4f78-b7b9-b39a6e3095ff</onsuccess><code><![CDATA[Success = False

If Main_Collection.Columns.Count > 0 AndAlso Main_Collection.Columns.Count <> Collection_to_Append.Columns.Count Then
	Error_Message = "Field definitions do not match - the number of columns in each is different."
	Exit Sub
End If

For Each Col1 As DataColumn In Main_Collection.Columns

	If Not Collection_to_Append.Columns.Contains(Col1.ColumnName) Then
		Error_Message = "The Main Collection does not contain '" & Col1.ColumnName & "'"
		Exit Sub
	End If

	If Collection_to_Append.Columns(Col1.ColumnName).DataType.Name <> Col1.DataType.Name Then
		Error_Message = "The data type of '" & Col1.ColumnName & "' do not match."
		Exit Sub
	End If

Next

If Main_Collection.Columns.Count = 0 Then
	Combined_Collection = Collection_to_Append
Else
	'We can now assume that fields match and start copying rows
	For Each R As DataRow in Collection_to_Append.Rows
		Main_Collection.ImportRow(R)
	Next
	Combined_Collection = Main_Collection
End If

Success = True]]></code></stage><stage stageid="d0521477-9847-4a70-834b-9c1d315bd817" name="Combined Collection" type="Collection"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="35415fae-0f6d-4f78-b7b9-b39a6e3095ff" name="Success?" type="Decision"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>4edf169e-f809-4dd4-b3dd-77675a9e1cf6</ontrue><onfalse>e4269f55-7633-4d19-9ebf-299956a4a5ec</onfalse></stage><stage stageid="e4269f55-7633-4d19-9ebf-299956a4a5ec" name="System Exception" type="Exception"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>120</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="[Error Message]" /></stage><stage stageid="7923c865-f484-411d-815a-24fe9832f941" name="Success" type="Data"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>-240</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="710fce6c-64f2-4e2d-8c89-9c2c41b9e9cb" name="Error Message" type="Data"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bdd84939-c1c2-4ec3-9ec2-f19a6b55f056" name="Remove Empty Rows" type="SubSheetInfo"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><narrative>Removes empty rows from a collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="46ac86fc-42a2-49f4-a2be-86a452176e2b" name="Start" type="Start"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have empty rows removed." /></postconditions><narrative></narrative><displayx>-15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to remove empty rows from" stage="Collection In" /></inputs><onsuccess>6c450e6a-55ae-4382-a419-e4c6d59fc580</onsuccess></stage><stage stageid="0e663c5b-fb8a-4f15-999d-feb951956864" name="End" type="End"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with the empty rows removed" stage="Collection Out" /></outputs></stage><stage stageid="613bed47-0c41-4155-93a3-5b31823f6048" name="Collection In" type="Collection"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><narrative></narrative><displayx>60</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="af6c216c-aac3-4b4e-b7cb-bbf0a7863c49" name="Collection Out" type="Collection"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><narrative></narrative><displayx>60</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6c450e6a-55ae-4382-a419-e4c6d59fc580" name="Remove empty rows" type="Code"><subsheetid>fa6ed646-8ae1-479e-9845-b1dc9ac3b560</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>0e663c5b-fb8a-4f15-999d-feb951956864</onsuccess><code><![CDATA[
Dim bRemove as Boolean
Dim iRow as integer
' Loop through each row
For iRow = Collection_In.Rows.Count - 1 to 0 step -1
'For each Row as DataRow in Collection_In.Rows
	bRemove=True
	' Loop through every column for this row
	For each Column as DataColumn in Collection_In.Columns
		if Trim(Collection_In.Rows(iRow)(Column.ColumnName).ToString()) & "" <> "" then
			bRemove=False
			exit for
		end if
	Next

	if bRemove=True then
		Collection_In.Rows.Remove(Collection_In.Rows(iRow))
	end if
Next

Collection_Out = Collection_In.Copy]]></code></stage><stage stageid="28f98de9-8408-4312-9e37-37197c2d8822" name="Transpose Collection" type="SubSheetInfo"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><narrative>Creates a new collection with the fields Name and Value and for each row in the original collection creates an entry for each column.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="26ce26e2-1a34-4a20-97d8-34ab15954720" name="Start" type="Start"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will be transposed." /></postconditions><narrative></narrative><displayx>30</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to transpose." stage="Collection In" /></inputs><onsuccess>c3e45cac-9a76-4b70-a119-ffed9ceeaeac</onsuccess></stage><stage stageid="c9852e45-8999-4b73-a581-4a3f66b95b3a" name="End" type="End"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The transposed collection." stage="Collection Out" /></outputs></stage><stage stageid="c3e45cac-9a76-4b70-a119-ffed9ceeaeac" name="Transpose" type="Code"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>c9852e45-8999-4b73-a581-4a3f66b95b3a</onsuccess><code><![CDATA[
New_Collection = GetDataTable("Name,Value", "System.String,System.String")
Dim New_Row As System.Data.DataRow

For Each r As System.Data.DataRow In Collection.Rows
	For Each c As System.Data.DataColumn In Collection.Columns
		New_Row = New_Collection.NewRow()
		New_Row("Name") = c.ColumnName
		New_Row("Value") = CStr(r(c.ColumnName))
		New_Collection.Rows.Add(New_Row)
	Next
Next
]]></code></stage><stage stageid="d2f68cb8-90cf-4414-8554-daf4fa4c9f29" name="Collection Out" type="Collection"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="99b09a03-6901-47ee-af4d-d43bfcf3bb42" name="Collection In" type="Collection"><subsheetid>a0cf6615-20c0-4910-9990-0f79f5f30bca</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="90d519f8-3075-478e-a49f-b681d1ddd033" name="Field Exists" type="SubSheetInfo"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><narrative>Finds out whether the collection contatins a given field.</narrative><displayx>-135</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8605b0b2-ff16-473b-ba5d-1956390f48bd" name="Start" type="Start"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><narrative></narrative><displayx>75</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection to check." stage="Input Collection" /><input type="text" name="Field" narrative="The field to check for." stage="Field" /></inputs><onsuccess>da5abfb8-f52a-4a03-8f9f-ec5e42dd4566</onsuccess></stage><stage stageid="26b8ca01-8895-483f-93ef-66df5bbb0a34" name="End" type="End"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Exists" narrative="True if the collection contains the field." stage="Exists" /></outputs></stage><stage stageid="da5abfb8-f52a-4a03-8f9f-ec5e42dd4566" name="Get Collection Fields" type="SubSheet"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Collection Fields" stage="Field Names" /></outputs><onsuccess>470c6c27-3ed4-43b7-8c01-3fc7415ec55e</onsuccess><processid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</processid></stage><stage stageid="a910c0ad-5130-4073-8f3a-8cf76bc7d74e" name="Input Collection" type="Collection"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="66e1609e-c3e7-4e35-82df-90254a0d842f" name="Field" type="Data"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="470c6c27-3ed4-43b7-8c01-3fc7415ec55e" name="Field Names" type="LoopStart"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>eb7af2be-1265-40b6-8ea7-89fdda2b0ab1</onsuccess><groupid>755a928d-1109-4393-b44a-e265a1395a22</groupid><looptype>ForEach</looptype><loopdata>Field Names</loopdata></stage><stage stageid="54fa6a7b-f874-43d4-ac4a-4c16f28d1a9f" name="Field Names" type="LoopEnd"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>195</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>26b8ca01-8895-483f-93ef-66df5bbb0a34</onsuccess><groupid>755a928d-1109-4393-b44a-e265a1395a22</groupid></stage><stage stageid="15f784c0-4879-4a2e-ab6f-c44f5c384d85" name="Field Names" type="Collection"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Field Name" type="text" /><field name="Data Type" type="text" /></collectioninfo></stage><stage stageid="905724f1-237f-4641-9511-289841ec3498" name="Exists" type="Data"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="eb7af2be-1265-40b6-8ea7-89fdda2b0ab1" name="Match?" type="Decision"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Field Names.Field Name] = Trim([Field])" /><ontrue>c4532590-c3c0-4014-98f4-bc3e1f30e5df</ontrue><onfalse>54fa6a7b-f874-43d4-ac4a-4c16f28d1a9f</onfalse></stage><stage stageid="d656772f-8ec9-4848-8f30-a4bda4f01837" name="anchor2" type="Anchor"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>255</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>26b8ca01-8895-483f-93ef-66df5bbb0a34</onsuccess></stage><stage stageid="c4532590-c3c0-4014-98f4-bc3e1f30e5df" name="Exists" type="Calculation"><subsheetid>4d41bfc8-e552-41ae-9e45-65dc3d1f7276</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d656772f-8ec9-4848-8f30-a4bda4f01837</onsuccess><calculation expression="True" stage="Exists" /></stage><stage stageid="2e050fc0-fed0-49b4-bafc-a33a0aee5ad9" name="Success?" type="Decision"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>c491f60e-4aa7-4abb-a203-5a78c0b64469</ontrue><onfalse>510a1b6e-59d7-40a0-8886-483ef66093e9</onfalse></stage><stage stageid="510a1b6e-59d7-40a0-8886-483ef66093e9" name="FAIL" type="Exception"><subsheetid>3a772458-463d-46cf-8451-6cf5b4aeae30</subsheetid><narrative></narrative><displayx>120</displayx><displayy>15</displayy><displaywidth>30</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="UtilityException" detail="&quot;Error occurred removing null rows: &quot; &amp; [Message]" /></stage><stage stageid="f171b068-9a41-41b1-a950-02c2bf846cae" name="Remove enters from headers" type="SubSheetInfo"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b93cee64-1b47-4fd4-a1ce-b3279c641d5a" name="Rename Column2" type="Code"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>7bdaaff0-5103-4aa7-ae83-63e89dfafd51</onsuccess><code><![CDATA[For Each Column As DataColumn In Input_Collection.Columns
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName, Chr(13), " ", , , vbTextCompare)
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName, Chr(10), " ", , , vbTextCompare)
Next
Output_Collection = Input_Collection]]></code></stage><stage stageid="7bdaaff0-5103-4aa7-ae83-63e89dfafd51" name="End" type="End"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>180</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The collection with the renamed column" stage="Output Collection" /></outputs></stage><stage stageid="2a36568c-a542-406c-9c47-147ba27467ad" name="Start" type="Start"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have fields with no dots." /></postconditions><narrative></narrative><displayx>0</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>b93cee64-1b47-4fd4-a1ce-b3279c641d5a</onsuccess></stage><stage stageid="f1333e60-36bf-4e68-9254-850c1aafcdc9" name="Input Collection" type="Collection"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><narrative></narrative><displayx>-210</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="da571b27-bba7-47ba-9896-16cd1d95e962" name="Note1" type="Note"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-210</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="802ed68b-d377-4352-8fdd-24be599ba22d" name="Output Collection" type="Collection"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><narrative></narrative><displayx>-210</displayx><displayy>225</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="17c12fae-ae0a-4c91-9645-0a69d32426d5" name="Note1" type="Note"><subsheetid>199bcb60-3d82-4aaa-91d1-c2497135326e</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-210</displayx><displayy>195</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="05998bfa-6b17-4c1d-bf5f-077d42ee42f2" name="Remove spaces from headers" type="SubSheetInfo"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-195</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="659d7780-6045-4c05-9a6b-1d0bfb0d26f9" name="Rename Column3" type="Code"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>c3628d46-cc48-4af8-bd5f-cf76b2240a4c</onsuccess><code><![CDATA[For Each Column As DataColumn In Input_Collection.Columns
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName," ","")
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName, Chr(34), "", , , vbTextCompare)
Next
Output_Collection = Input_Collection]]></code></stage><stage stageid="c3628d46-cc48-4af8-bd5f-cf76b2240a4c" name="End" type="End"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The collection with the renamed column" stage="Output Collection" /></outputs></stage><stage stageid="a36ef1b1-611a-40ff-b075-c9d7d5a23df2" name="Start" type="Start"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have fields with no dots." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>659d7780-6045-4c05-9a6b-1d0bfb0d26f9</onsuccess></stage><stage stageid="c62d6879-698f-4c60-a1ba-57b97bd2bc4a" name="Input Collection" type="Collection"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7181aa8e-968d-46fc-84ba-3eca1ef225a1" name="Note1" type="Note"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-195</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f7bf5a26-f7de-48e8-9e26-19e35cb43eb1" name="Output Collection" type="Collection"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f3368d20-e67d-4553-9e97-65e852c3dbc9" name="Note1" type="Note"><subsheetid>ff1a4e73-9c6b-4708-98f4-a05d8215609c</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e94f0a38-9645-4799-bc80-e52c5ab6c1b5" name="Clear Collection" type="Action"><subsheetid>a9f3108d-ca87-4551-b567-9c64ef05cf0c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection In&quot;" /></inputs><onsuccess>bda88544-a5a8-4bf6-9c9b-c645f76b7fed</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="e04a612f-9758-4be3-868d-e69d752d5e56" name="Find Value Index" type="SubSheetInfo"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="bb63ebc2-dc0a-4a69-a777-4c484d1f2eeb" name="End" type="End"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Success" stage="Success" /><output type="number" name="RowIndex" narrative="RowIndex" stage="RowIndex" /></outputs></stage><stage stageid="fbb17f2d-b24e-4936-bd0b-f7dc497a07cd" name="Search value" type="Code"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="iRow" expr="[iRow]" /><input type="collection" name="Existing Headers" expr="[Existing Headers]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="number" name="RowIndex" stage="RowIndex" /></outputs><onsuccess>bb63ebc2-dc0a-4a69-a777-4c484d1f2eeb</onsuccess><code><![CDATA['Dim iTotalColumns as integer = Existing_Headers.Rows.Count-1
'Dim jThisColumn as integer = Expected_Headers.Rows.Count-1
'Dim iThisColumn, jThisColumn as integer = -1
'For Each iRow As DataRow In Expected_Headers.Rows

   'If iThisColumn>=iTotalColumns Then Exit For
 '  iThisColumn +=1 
	
RowIndex = -1  
Success= False
For Each jRow As DataRow In Existing_Headers.Rows

   RowIndex +=1 

   if (cstr(jRow(0)) = iRow) Then 
		Success = true
		Exit For
end if
	Next]]></code></stage><stage stageid="85ec6de8-b4d1-495f-9d35-615a2f4e6676" name="Start" type="Start"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection fields will have been renamed." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Existing Headers" /><input type="text" name="iRow" narrative="iRow" stage="iRow" /></inputs><onsuccess>fbb17f2d-b24e-4936-bd0b-f7dc497a07cd</onsuccess></stage><stage stageid="4ce2911d-dc2d-450c-b274-da92c09fa144" name="Existing Headers" type="Collection"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /><collectioninfo><field name="Header Name" type="text" /></collectioninfo></stage><stage stageid="e6e4239d-5272-4e12-a30c-f89333bc1123" name="RowIndex" type="Data"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="93cdca9a-bc89-47b6-be5c-f66cf589a08b" name="Success" type="Data"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a4a91474-d73e-4f53-9056-56814b84df49" name="iRow" type="Data"><subsheetid>39b89826-71e0-4668-8d04-c535f08bd13f</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0d1595ec-9550-4b35-97fa-4bff53278a09" name="Count Distinct" type="SubSheetInfo"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f461d89a-a680-4074-9887-74d4fa56c180" name="Start" type="Start"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Data" narrative="Data" stage="Data" /></inputs><onsuccess>36961cd8-6faa-444c-ac46-d88e1bebd680</onsuccess></stage><stage stageid="68402241-f487-4083-aadf-6ca1812243c0" name="End" type="End"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Unique" narrative="Unique" stage="Unique" /></outputs></stage><stage stageid="36961cd8-6faa-444c-ac46-d88e1bebd680" name="Code2" type="Code"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Data" expr="[Data]" /></inputs><outputs><output type="number" name="Unique" stage="Unique" /></outputs><onsuccess>68402241-f487-4083-aadf-6ca1812243c0</onsuccess><code><![CDATA[  Dim arr As New Collection
dim a as System.Data.DataRow
  Dim i As Long 

On Error Resume Next 
  For Each a In Data.Rows
	'if (not arr.Contains(a(0)))
        arr.Add(a(0), a(0)) 
   ' end if
  Next 

Unique = arr.Count]]></code></stage><stage stageid="6cbd0778-b76a-43ab-adf9-1ca80e1561ba" name="Data" type="Collection"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="3b03c39d-e143-48c3-b474-e4f6cc64b572" name="Unique" type="Data"><subsheetid>9b268688-af7c-4803-85a9-dceab8c00654</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f90afd05-c29f-42dd-a386-3e22e30ddd3b" name="Set Column Names From First Row" type="SubSheetInfo"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><narrative>If you have a collection with the column names all in the first row, this will set the column names to the values in that row and then detete the first row.
Handy for collections read using Get Table</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f9f88946-1d95-434e-a38b-74f693b50e64" name="Start" type="Start"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>09952d1b-9f54-4e91-bff8-4e3bd602e184</onsuccess></stage><stage stageid="c76302d4-2ae2-40be-8d77-c4bc80829d24" name="End" type="End"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The amended collection" stage="Output Collection" /></outputs></stage><stage stageid="a65dd51a-752e-4584-8323-dd55d94ec9d7" name="Set First Row" type="Code"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>c76302d4-2ae2-40be-8d77-c4bc80829d24</onsuccess><code><![CDATA[
'Input_Collection.Columns(3).ColumnName="NewColumnName"
'Output_Collection = Input_Collection


Dim rowInt as integer = Input_Collection.rows.count()
'Input_Collection.rows(2) = Input_Collection.rows(1)
For Each Row As DataRow In Input_Collection.Rows
	Row(rowInt-1)=Row(rowInt)
	rowInt = rowInt-1
	If rowInt = 1 Then
		For Each Column as DataColumn In Input_Collection.Columns
			'Loop through Rows and set Column.ColumnName = Row(0) = Row(rowInt-1)
		Next
	End If
Next
Output_Collection = Input_Collection
	


'If RowIndex < 0 OrElse Coll.Rows.Count <= RowIndex Then
'	Throw New ApplicationException("The supplied row index falls outside of the valid range.")
'End If

'If Not Coll.Columns.Contains(FieldName) Then
'   Throw New ApplicationException("The collection does not contain a field with the name '" & FieldName & "'")
'End If

'Value_Read = CStr(Coll.Rows(RowIndex)(FieldName))]]></code></stage><stage stageid="e1e278a9-07fb-4420-9c0e-352ea90c9ffe" name="Input Collection" type="Collection"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="a8d2a22e-b6cd-4aca-a25c-f27f41c686ea" name="Output Collection" type="Collection"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><narrative></narrative><displayx>120</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="09952d1b-9f54-4e91-bff8-4e3bd602e184" name="Add a new row" type="Action"><subsheetid>c8d54842-b057-4678-851e-c6a84eb1354b</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Input Collection&quot;" /></inputs><onsuccess>a65dd51a-752e-4584-8323-dd55d94ec9d7</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="a8747ec2-b1e8-4f31-8f19-c46c5ed9d56e" name="Collection Contains Value" type="SubSheetInfo"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative>Searches for the existence of a value or a regular expression in a specified column in a collection. This will return true and, if a regular expression was provided, the groups defined in that regex for the first matched value it finds in the collection.</narrative><displayx>-255</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="82668185-f65a-4856-b359-289ab6f3653f" name="Start" type="Start"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><preconditions><condition narrative="A collection exists with the specified column name which may or may not contain a particular value" /><condition narrative="The collection being searched has no date or time columns (A code stage restriction)" /><condition narrative="" /><condition narrative="" /></preconditions><postconditions><condition narrative="No change" /></postconditions><narrative>Note that if neither 'Exact Value' nor 'Regex' are supplied, this will always return FALSE / ie. not found. If a match is found, groups will return all of the groups specified in the regular expression when applied to the value found.</narrative><displayx>-30</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="Required : The collection to search" stage="Collection" /><input type="text" name="Column Name" narrative="Required : The name of the column to search" stage="Column Name" /><input type="text" name="Exact Value" narrative="Optional : The exact value to search for - this is case insensitive" stage="Exact Value" /><input type="text" name="Regex" narrative="Optional : The regular expression to search for - this is case sensitive unless specified otherwise in the regular expression using &quot;(?i)&quot;" stage="Regex" /></inputs><onsuccess>64bf1d32-27d6-4600-92f0-39d71f2fa65c</onsuccess></stage><stage stageid="79579ee8-8576-4599-aad4-f5cbb73e4374" name="End" type="End"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Contains Search Term" narrative="Flag indicating if the collection found the given search term or not" stage="Contains Search Term" /><output type="collection" name="Groups" narrative="The groups defined in the regular expression when it is applied to the found term" stage="Groups" /></outputs></stage><stage stageid="6d4103dd-d35e-48c6-8807-f668ba17a938" name="Collection" type="Collection"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="91a3e89d-316d-49ac-b41b-7c2e7cc2ab2f" name="Column Name" type="Data"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2899fe0d-d170-4fcd-8947-aee0f32814b4" name="Exact Value" type="Data"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>60</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="83eaf3f2-3af0-4d8f-ad51-db8a8e903c6a" name="Regex" type="Data"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>90</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f98f4c56-58d5-40f3-8d8c-8a2f8d816f1c" name="Contains Search Term" type="Data"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="abfb84f1-75d4-4728-a407-342d5f81bd28" name="Groups" type="Collection"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Group" type="text" /></collectioninfo></stage><stage stageid="c62073d6-ffcc-4752-a644-f384b4ed5533" name="Note2" type="Note"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-330</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e8c5bb7a-eaf8-49dc-a404-6f77eec3d24f" name="Note2" type="Note"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-180</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8e6d217f-0610-4785-ae09-37e92610b88a" name="Both Search Strings Empty?" type="Decision"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Len([Exact Value]) = 0 AND Len ([Regex]) = 0" /><ontrue>556709e0-5116-41f5-aa69-998eb18c739c</ontrue><onfalse>bc017b10-ca12-4013-a031-291358339325</onfalse></stage><stage stageid="64bf1d32-27d6-4600-92f0-39d71f2fa65c" name="Trim Search Strings" type="MultipleCalculation"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8e6d217f-0610-4785-ae09-37e92610b88a</onsuccess><steps><calculation expression="Trim([Exact Value])" stage="Exact Value" /><calculation expression="Trim([Regex])" stage="Regex" /></steps></stage><stage stageid="556709e0-5116-41f5-aa69-998eb18c739c" name="anchor3" type="Anchor"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c74100d2-4063-43db-8235-ee2c3d04f14e</onsuccess></stage><stage stageid="c74100d2-4063-43db-8235-ee2c3d04f14e" name="anchor4" type="Anchor"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>90</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>79579ee8-8576-4599-aad4-f5cbb73e4374</onsuccess></stage><stage stageid="bc017b10-ca12-4013-a031-291358339325" name="Search Collection substring" type="Code"><subsheetid>a2d64ca7-f8be-4aff-8600-00cb2d4fdf35</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="coll" expr="[Collection]" /><input type="text" name="colname" expr="[Column Name]" /><input type="text" name="exactVal" expr="[Exact Value]" /><input type="text" name="regexVal" expr="[Regex]" /></inputs><outputs><output type="flag" name="found" stage="Contains Search Term" /><output type="collection" name="groups" stage="Groups" /></outputs><onsuccess>79579ee8-8576-4599-aad4-f5cbb73e4374</onsuccess><code><![CDATA[If Not Coll.Columns.Contains(colname) Then
  Throw New ApplicationException(String.Format( _
   "The collection does not contain a field " & _
   "with the name '{0}'", colname))
End If

Dim rx as Regex
If Not String.IsNullOrEmpty(exactVal) Then
  rx = New Regex(Regex.Escape(exactVal), RegexOptions.IgnoreCase)
Else
  ' If ignore case is required it can be inlined using "(?i)..rest of search"
  rx = New Regex(regexVal)
End If

' Initialise output params
found = False
groups = New DataTable()
groups.Columns.Add("Group", GetType(String))

For Each row as DataRow in coll.Rows

  Dim val as String = CStr(row(colname))
  Dim m as Match = rx.Match(Trim(val))
  If m.Success Then
    found = True
    For i as Integer = 1 to m.Groups.Count-1
      groups.Rows.Add(New Object() {m.Groups(i).Value})
    Next
    Return
  End If

Next]]></code></stage><stage stageid="bd0748a3-73d9-455a-84a6-df541fc85e8c" name="Clear Collections" type="Block"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>-60</displayx><displayy>225</displayy><displaywidth>270</displaywidth><displayheight>240</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="bb6a782a-c599-42f2-8bba-f8c298f65be6" name="Clear Exisiting Headers Collection" type="Action"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>255</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Existing Headers&quot;" /></inputs><onsuccess>220f8a72-c618-4b1a-82da-06cbd55c7b91</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="220f8a72-c618-4b1a-82da-06cbd55c7b91" name="Clear Expected Fields/Columns" type="Action"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>300</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Expected Fields/Columns&quot;" /></inputs><onsuccess>4dbe8bc0-d9b0-4a80-839d-3963e82f8aec</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="4dbe8bc0-d9b0-4a80-839d-3963e82f8aec" name="Clear Field Names" type="Action"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>345</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Field Names&quot;" /></inputs><onsuccess>3ec7d015-2404-4fff-bc3f-776de23b0960</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="3ec7d015-2404-4fff-bc3f-776de23b0960" name="Clear Input Collection" type="Action"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>390</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Input Collection&quot;" /></inputs><onsuccess>0e96a0eb-7c95-45a1-9b0c-0f47db616547</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="0e96a0eb-7c95-45a1-9b0c-0f47db616547" name="Invoke GC" type="Action"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>450</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>15854162-6197-477a-873b-73c9b453d0d3</onsuccess><resource object="Utility - Custom (C#)" action="Invoke GC" /></stage><stage stageid="4c50ed56-655c-4c71-9ae8-865c3fbd0330" name="Clear Collection" type="Action"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection&quot;" /></inputs><onsuccess>2a6d86a8-8937-4d4b-9da4-32813d06a0bf</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="4edf169e-f809-4dd4-b3dd-77675a9e1cf6" name="Clear Collection" type="Action"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Main Collection&quot;" /></inputs><onsuccess>13daa425-f7b6-4e5d-8ca2-de1129924ee8</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="13daa425-f7b6-4e5d-8ca2-de1129924ee8" name="Clear Collection" type="Action"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>195</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Collection to Append&quot;" /></inputs><onsuccess>5d1a3d8d-2e99-49b5-9863-6a866e2e03dd</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Remove All Rows" /></stage><stage stageid="63aa17a1-ce6b-4635-b174-b5996cc72221" name="Recover1" type="Recover"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c4763695-7c64-4504-b70f-2598427ea37f</onsuccess></stage><stage stageid="2a8fa29a-b14c-4241-a5ca-2b47aef75a45" name="Resume1" type="Resume"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>5d1a3d8d-2e99-49b5-9863-6a866e2e03dd</onsuccess></stage><stage stageid="c4763695-7c64-4504-b70f-2598427ea37f" name="Note3" type="Note"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative>Assume Single Row Collection</narrative><displayx>120</displayx><displayy>195</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2a8fa29a-b14c-4241-a5ca-2b47aef75a45</onsuccess></stage><stage stageid="6e26828c-696b-4216-87b5-2beb304d04de" name="Block1" type="Block"><subsheetid>51f694a8-5305-4a38-9b41-a98998f2f7ca</subsheetid><loginhibit /><narrative></narrative><displayx>-60</displayx><displayy>105</displayy><displaywidth>255</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4bac5452-438d-4614-841a-ea4d9ea439b7" name="Recover1" type="Recover"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>270</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>0922005f-d925-48fe-8024-74ace9754954</onsuccess></stage><stage stageid="58bc4876-c473-4e95-a392-fd9f5bda8d1f" name="Resume1" type="Resume"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative></narrative><displayx>120</displayx><displayy>495</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>15854162-6197-477a-873b-73c9b453d0d3</onsuccess></stage><stage stageid="0922005f-d925-48fe-8024-74ace9754954" name="Note3" type="Note"><subsheetid>7a9aa259-fe07-4035-8411-23737559c975</subsheetid><loginhibit /><narrative>Assume Single Row Collection</narrative><displayx>120</displayx><displayy>330</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>58bc4876-c473-4e95-a392-fd9f5bda8d1f</onsuccess></stage><stage stageid="b21348c8-afaf-4ea9-a89f-374b2f291825" name="Recover1" type="Recover"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>4373b2ce-0b7d-42b9-a7f0-0284ffd65758</onsuccess></stage><stage stageid="52f4ad83-71ee-4fac-a506-b241eb5e7853" name="Resume1" type="Resume"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>150</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>2a6d86a8-8937-4d4b-9da4-32813d06a0bf</onsuccess></stage><stage stageid="4373b2ce-0b7d-42b9-a7f0-0284ffd65758" name="Note3" type="Note"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative>Assume Single Row Collection</narrative><displayx>150</displayx><displayy>105</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>52f4ad83-71ee-4fac-a506-b241eb5e7853</onsuccess></stage><stage stageid="face0f64-227e-4d07-8c1a-567f6313ed49" name="Block1" type="Block"><subsheetid>198ce3c6-ecbf-4203-a609-b15429defe0e</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>15</displayy><displaywidth>255</displaywidth><displayheight>120</displayheight><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="28c176a5-5367-43e9-85e7-e8e167568542" name="Copy Rows" type="SubSheetInfo"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative>Copies the rows of the given collection into a new collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="bd8f4b47-e6c2-41bc-b190-d7c4fa0cd292" name="Start" type="Start"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="number" name="Index" narrative="The row index to copy in" stage="Index" /><input type="collection" name="Source Collection" narrative="The collection to copy." stage="Source Collection" /></inputs><onsuccess>009e7ee9-63e7-4b94-aff2-1288c6351f65</onsuccess></stage><stage stageid="f3bb6748-1963-4703-92ac-f80e70647a4e" name="End" type="End"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The copied collection." stage="Output Collection" /></outputs></stage><stage stageid="2b1122a2-126b-486c-9457-b5d7f1603f26" name="Index" type="Data"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>60</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>3</initialvalue><private /><alwaysinit /></stage><stage stageid="72f518ed-fa98-4972-b964-18624d03b334" name="Source Collection" type="Collection"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>255</displayx><displayy>-120</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="009e7ee9-63e7-4b94-aff2-1288c6351f65" name="Add row at index" type="Code"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Source Collection" expr="[Source Collection]" /><input type="number" name="Index" expr="[Index]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs><onsuccess>710db4af-e845-47b0-8cc0-41dec9021e4b</onsuccess><code><![CDATA[try 
If Index < 0 OrElse Source_Collection.Rows.Count <= Index Then
	Throw New ApplicationException("The supplied row index falls outside of the valid range.")
end if
Dim newRow as DataRow 
newRow = Source_Collection.NewRow()
Source_Collection.Rows.InsertAt(newRow, Index)
Output_Collection = Source_Collection.Copy
	Success = True
Catch Ex As Exception
	Success = False
	Error_Message = Ex.ToString()
end try


]]></code></stage><stage stageid="8e932e8a-6ceb-4a82-a55a-6fb1e918d885" name="Output Collection" type="Collection"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c7a3a373-773f-492b-86e5-63c23a63bf13" name="Success" type="Data"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>60</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d9ee6fc5-c89e-4e49-9043-4856f8b6ddb2" name="Error Message" type="Data"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>120</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="710db4af-e845-47b0-8cc0-41dec9021e4b" name="Success?" type="Decision"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>f3bb6748-1963-4703-92ac-f80e70647a4e</ontrue><onfalse>2066859c-9fe6-4c21-b415-9cc7d041e89f</onfalse></stage><stage stageid="2066859c-9fe6-4c21-b415-9cc7d041e89f" name="System Exception" type="Exception"><subsheetid>2954e4fb-0fc4-435b-852d-be185135e6fb</subsheetid><narrative></narrative><displayx>90</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="[Error Message]" /></stage><stage stageid="56d5930b-0b30-445d-a9f4-61f3476ea3e3" name="Write Collection To Text File" type="SubSheetInfo"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="83b3e7d1-af41-4dfb-aa6f-c1b6c9152074" name="Start" type="Start"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="I_Collection" stage="I_Collection" /><input type="text" name="I_FilePath" stage="I_FilePath" /></inputs><onsuccess>25833c89-553a-486c-92e5-812d3e73f94b</onsuccess></stage><stage stageid="db7e4492-fdc8-42cd-aadb-69a32d29efca" name="End" type="End"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="25833c89-553a-486c-92e5-812d3e73f94b" name="Write Data" type="Code"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="I_Coll" expr="[I_Collection]" /><input type="text" name="FilePath" expr="[I_FilePath]" /></inputs><onsuccess>db7e4492-fdc8-42cd-aadb-69a32d29efca</onsuccess><code><![CDATA[   
       ' Dim filename As String = "P:\France-ParallelRun\Test.txt"

        Dim _nRowIndex As Integer = 1
        Using _objWriter As New StreamWriter(FilePath, False, Encoding.UTF8)
            For Each row As DataRow In I_Coll.Rows
                _nRowIndex += 1
                For Each col As DataColumn In I_Coll.Columns
                    _objWriter.WriteLine(row(col.ColumnName).ToString())
                Next
            Next
        End Using
]]></code></stage><stage stageid="0f8e4aaf-dae8-4427-ae75-db4b8a7a3631" name="I_Collection" type="Collection"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="de312b5b-c629-4cbd-a24c-17f252451421" name="I_FilePath" type="Data"><subsheetid>79afd981-15a2-4fe9-9023-bda54e603c0d</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="50a28c0e-f830-408e-aa44-e64e7b91e7ea" name="Add Value To Column" type="SubSheetInfo"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><narrative>Appends a field to a collection and allows you to provide a default number value for the field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="02c7f36b-6967-467a-8787-bfb1edc5eec6" name="Start" type="Start"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have the new field appended to it." /></postconditions><narrative></narrative><displayx>30</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="number" name="Value" narrative="The value to be put in the new field." stage="Value" /></inputs><onsuccess>f4245861-cc47-4eda-9540-7992f8dc8114</onsuccess></stage><stage stageid="53a968f5-a8e7-40ac-9b98-6030095c764a" name="End" type="End"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="f4245861-cc47-4eda-9540-7992f8dc8114" name="Append Number - Incremental Values" type="Code"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><loginhibit /><narrative></narrative><displayx>30</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="number" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>53a968f5-a8e7-40ac-9b98-6030095c764a</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.Decimal"))
End If
For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
	Value=Value+1
Next

New_Collection = Collection
]]></code></stage><stage stageid="5d5c208d-eef7-4619-9a34-dc7b94bf9605" name="Collection Out" type="Collection"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9c04b5c4-1799-46b5-bf19-d014f29c9118" name="Field Name" type="Data"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ecc9f49a-f9e2-421e-8c71-a51c38a46854" name="Collection In" type="Collection"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="8ff6a3d6-254b-419d-b95d-5a530ee33559" name="Value" type="Data"><subsheetid>67bcfaab-2af9-489a-bd35-96b60f2870fb</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="e37b59c2-c7a6-4940-bfd3-f0aee09681c5" name="Remove Empty Rows" type="SubSheetInfo"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><narrative>Removes empty rows from a collection.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8695b6b1-20ea-42b7-b058-ead991aa78c0" name="Start" type="Start"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have empty rows removed." /></postconditions><narrative></narrative><displayx>-15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to remove empty rows from" stage="Collection In" /><input type="number" name="Row_Index" stage="I_Row_Index" /></inputs><onsuccess>1f93a103-1f9d-4b50-817f-aa75166c60c2</onsuccess></stage><stage stageid="a194e8e2-0286-4469-866b-c13f277664ed" name="End" type="End"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with the empty rows removed" stage="Collection Out" /></outputs></stage><stage stageid="0f07fa48-07f7-4c3d-914e-2a2717f100d2" name="Collection In" type="Collection"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1e77ddf9-e973-401a-9ac7-a624d6ed62e4" name="Collection Out" type="Collection"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><narrative></narrative><displayx>-285</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1f93a103-1f9d-4b50-817f-aa75166c60c2" name="Remove Row At Index" type="Code"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /><input type="number" name="Row Index" expr="[I_Row_Index]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>a194e8e2-0286-4469-866b-c13f277664ed</onsuccess><code><![CDATA[Collection_In.Rows.Remove(Collection_In.Rows(Row_Index))
Collection_Out = Collection_In.Copy]]></code></stage><stage stageid="2fa067a7-fc4a-4bba-a1b5-c875f9adad1e" name="I_Row_Index" type="Data"><subsheetid>03ffe425-1a93-43ce-828a-68932853dd37</subsheetid><loginhibit /><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>1</initialvalue><private /><alwaysinit /></stage><stage stageid="3189db12-f1fa-4eb4-9e32-408480719065" name="Rename Collection Fields" type="SubSheetInfo"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative>Renames the fields of a collection based on the fields of a given name mapping collection.</narrative><displayx>-60</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d1d58a80-0d37-4d84-8752-1c004e1e09a8" name="Start" type="Start"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection fields will have been renamed." /></postconditions><narrative></narrative><displayx>105</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" narrative="The main collection, whose headers are to be modified" stage="Main Collection" /><input type="collection" name="New Headers" narrative="A collection of new headers. This must be a one-row collection matching the fields of the first. The first row will contain the new field names under the corresponding field names" stage="New Headers" /></inputs><onsuccess>7228cb48-17d7-4445-924f-42de6a976b9f</onsuccess></stage><stage stageid="b42f6131-1ad9-4011-931a-5a348cf34abd" name="End" type="End"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Amended Collection" stage="Amended Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs></stage><stage stageid="a3750b28-5473-41fd-9009-be223f09842c" name="New Headers" type="Collection"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><initialvalue><row><field name="Column 1" type="text" value="Name" /><field name="Column 2" type="text" value="Age" /></row></initialvalue></stage><stage stageid="7228cb48-17d7-4445-924f-42de6a976b9f" name="Rename Headers-Copy" type="Code"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" expr="[Main Collection]" /><input type="collection" name="New Headers" expr="[New Headers]" /></inputs><outputs><output type="collection" name="Amended Collection" stage="Amended Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Error Message" /></outputs><onsuccess>b42f6131-1ad9-4011-931a-5a348cf34abd</onsuccess><code><![CDATA[If Main_Collection IsNot Nothing AndAlso New_Headers IsNot Nothing Then
	If Main_Collection.Columns.Count = New_Headers.Columns.count Then
		'For Each Col1 As DataColumn In Main_Collection.Columns
			'If Not New_Headers.Columns.Contains(Col1.ColumnName) Then
				'Success = False
				'Error_Message = "New Headers collection does not contain the field '" & Col1.ColumnName & "' found in the Main Collection"
				'Exit Sub
			'End If
		'Next

		'We can now assume that fields match
		'and start copying rows
dim cnt as integer=0
		For Each C As DataColumn In Main_Collection.Columns
			Dim NewName As String = Cstr(New_Headers.Rows(0)(cnt))
			If String.IsNullOrEmpty(NewName) Then
				Throw New ApplicationException("Blank field names are not acceptable")
			Else
				C.ColumnName = Trim(NewName)
			End If
cnt+=1
		Next

		Main_Collection.AcceptChanges()
		Amended_Collection = Main_Collection
		Success = True
	Else
		Success = False
		Error_Message = "Collection field definitions do not match - the number of columns in each is different."
	End If
Else
	Success = False
	Error_Message = "Neither Collection may be null"
End If]]></code></stage><stage stageid="66c10a46-f907-47cd-889a-e160823f29a5" name="Success" type="Data"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative></narrative><displayx>240</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ad1bc095-e0e0-4db3-bcb4-e38fbb5512e1" name="Error Message" type="Data"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative></narrative><displayx>180</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="302dfd70-d8c7-4389-80c8-c20df61cc4d7" name="Main Collection" type="Collection"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative></narrative><displayx>210</displayx><displayy>-90</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><initialvalue><row><field name="Column 1" type="text" value="asdf" /><field name="Column 2" type="text" value="34" /></row></initialvalue></stage><stage stageid="9e0ae9ba-b332-4127-b2d3-34586a4e8f6c" name="Amended Collection" type="Collection"><subsheetid>7c3a0cf3-8a08-412f-9ef9-ac172c0a96ea</subsheetid><narrative></narrative><displayx>360</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2a83f0b3-5bf0-4f97-8f50-a38e6342c84f" name="Get Collection Index from Value" type="SubSheetInfo"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><narrative>Searches for the existence of a value or a regular expression in a specified column in a collection. This will return true and, if a regular expression was provided, the groups defined in that regex for the first matched value it finds in the collection.</narrative><displayx>-255</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b7160ba6-bf61-43eb-b134-68e107f871cc" name="Start" type="Start"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><preconditions><condition narrative="A collection exists with the specified column name which may or may not contain a particular value" /><condition narrative="The collection being searched has no date or time columns (A code stage restriction)" /></preconditions><postconditions><condition narrative="No change" /></postconditions><narrative>Note that if neither 'Exact Value' nor 'Regex' are supplied, this will always return FALSE / ie. not found. If a match is found, groups will return all of the groups specified in the regular expression when applied to the value found.</narrative><displayx>-30</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="Required : The collection to search" stage="Collection" /><input type="text" name="Column Name" narrative="Required : The name of the column to search" stage="Column Name" /><input type="text" name="Row Value" narrative="Optional : The exact value to search for - this is case insensitive" stage="Row Value" /></inputs><onsuccess>af269800-443b-4964-a86b-f65454b7e372</onsuccess></stage><stage stageid="0dda2a84-db72-419c-8a9c-f0b3ef7bf560" name="End" type="End"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Row Index" stage="Row Index" /></outputs></stage><stage stageid="568f64a5-6b68-44f0-9868-0cca3b64d5fd" name="Collection" type="Collection"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="c6c07a77-837a-47a3-adbb-2e2900720d10" name="Column Name" type="Data"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Col1</initialvalue><private /><alwaysinit /></stage><stage stageid="decf8ed7-4f15-43ff-8d8c-3da9ebff9199" name="Note2" type="Note"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-330</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a0767d29-26cb-4313-b355-c170696cd159" name="Note2" type="Note"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-180</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="8720f24a-adcc-438b-821b-cb7327164c06" name="Both Search Strings Empty?" type="Decision"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Row Value] = &quot;&quot;" /><ontrue>f9f4d674-f802-4ede-8a58-5e3ac3050589</ontrue><onfalse>7624a6dc-2f25-4505-8819-364029a4e64e</onfalse></stage><stage stageid="af269800-443b-4964-a86b-f65454b7e372" name="Trim Search Strings" type="MultipleCalculation"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8720f24a-adcc-438b-821b-cb7327164c06</onsuccess><steps><calculation expression="Trim([Row Value])" stage="Row Value" /></steps></stage><stage stageid="f9f4d674-f802-4ede-8a58-5e3ac3050589" name="anchor3" type="Anchor"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>e70e6efd-a432-4a9c-ac54-14102fbd40d6</onsuccess></stage><stage stageid="e70e6efd-a432-4a9c-ac54-14102fbd40d6" name="anchor4" type="Anchor"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>90</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>0dda2a84-db72-419c-8a9c-f0b3ef7bf560</onsuccess></stage><stage stageid="81b305b1-0862-4ec2-a14d-9ed753df5ba2" name="Row Value" type="Data"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>-345</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7624a6dc-2f25-4505-8819-364029a4e64e" name="Read Field1" type="Code"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll" expr="[Collection]" /><input type="text" name="FieldName" expr="[Column Name]" /><input type="text" name="RowValue" expr="[Row Value]" /></inputs><outputs><output type="number" name="Value_Read" stage="Row Index" /></outputs><onsuccess>0dda2a84-db72-419c-8a9c-f0b3ef7bf560</onsuccess><code><![CDATA[Dim i As Integer
For i = 0 To Coll.Rows.Count - 1
            If Coll.Rows(i)(FieldName) = RowValue Then
                Value_Read = i
                Exit For
            End If
        Next
Value_Read = Value_Read +1
]]></code></stage><stage stageid="99ef7e24-239a-4fac-87bf-d2b79476f2cc" name="Row Index" type="Data"><subsheetid>2a0b8565-e059-4412-ad46-ad8f244fead3</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2a639bab-f5f9-4eb9-ba43-d5263d6b2bda" name="Find Value Index" type="SubSheetInfo"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="d2143fbc-e339-408b-856d-578725fdd993" name="End" type="End"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Success" stage="Success" /><output type="number" name="RowIndex" narrative="RowIndex" stage="RowIndex" /></outputs></stage><stage stageid="77f1f8d6-0bf7-480a-a7fe-191e772180ec" name="Search value new" type="Code"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="iRow" expr="[iRow]" /><input type="collection" name="Existing Headers" expr="[Existing Headers - new]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="number" name="RowIndex" stage="RowIndex" /></outputs><onsuccess>d2143fbc-e339-408b-856d-578725fdd993</onsuccess><code><![CDATA['Dim iTotalColumns as integer = Existing_Headers.Rows.Count-1
'Dim jThisColumn as integer = Expected_Headers.Rows.Count-1
'Dim iThisColumn, jThisColumn as integer = -1
'For Each iRow As DataRow In Expected_Headers.Rows

   'If iThisColumn>=iTotalColumns Then Exit For
 '  iThisColumn +=1 
	
RowIndex = -1  
Success= False
For Each jRow As DataRow In Existing_Headers.Rows

   RowIndex +=1 

   if (cstr(jRow(0)) = iRow) Then 
		Success = true
		Exit For
end if
	Next]]></code></stage><stage stageid="1f081490-0cf6-4b1e-b4a1-7af267379f53" name="Start" type="Start"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection fields will have been renamed." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Existing Headers - new" /><input type="text" name="iRow" narrative="iRow" stage="iRow" /></inputs><onsuccess>77f1f8d6-0bf7-480a-a7fe-191e772180ec</onsuccess></stage><stage stageid="89704de6-a6f0-4e03-82ac-894976d12f9c" name="Existing Headers - new" type="Collection"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><alwaysinit /></stage><stage stageid="6333baef-b616-4e74-b8e7-5d58e09b90a8" name="RowIndex" type="Data"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2bff7b6a-820f-46f8-86be-65e6f814f8d1" name="Success" type="Data"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="73035c71-69ed-4407-b2bd-3c09895d390a" name="iRow" type="Data"><subsheetid>44048047-cae7-4d78-b237-d65a9afd4b5a</subsheetid><loginhibit /><narrative></narrative><displayx>-270</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="10987e80-dab8-408a-ac0e-efe9fc9418b9" name="Get Collection Index from Value - Copy" type="SubSheetInfo"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><narrative>Searches for the existence of a value or a regular expression in a specified column in a collection. This will return true and, if a regular expression was provided, the groups defined in that regex for the first matched value it finds in the collection.</narrative><displayx>-255</displayx><displayy>-105</displayy><displaywidth>270</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d84fcfb3-1710-44b3-9168-61e5d15e1512" name="Start" type="Start"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><preconditions><condition narrative="A collection exists with the specified column name which may or may not contain a particular value" /><condition narrative="The collection being searched has no date or time columns (A code stage restriction)" /></preconditions><postconditions><condition narrative="No change" /></postconditions><narrative>Note that if neither 'Exact Value' nor 'Regex' are supplied, this will always return FALSE / ie. not found. If a match is found, groups will return all of the groups specified in the regular expression when applied to the value found.</narrative><displayx>-30</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="Required : The collection to search" stage="Collection" /><input type="text" name="Column Name" narrative="Required : The name of the column to search" stage="Column Name" /><input type="text" name="Row Value" narrative="Optional : The exact value to search for - this is case insensitive" stage="Row Value" /></inputs><onsuccess>58ed030a-8006-4105-9773-a7541662b4e4</onsuccess></stage><stage stageid="b8717f16-a18a-4e48-baff-b73c0fe1977c" name="End" type="End"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Row Index" stage="Row Index" /></outputs></stage><stage stageid="58c13e68-ad5b-4d6b-813f-db1acf098546" name="Collection" type="Collection"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="24c9ef08-f575-4b93-999b-62b674f907c3" name="Column Name" type="Data"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><narrative></narrative><displayx>-330</displayx><displayy>30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Col1</initialvalue><private /><alwaysinit /></stage><stage stageid="b5c6a471-958d-4e5f-a12b-469e9bc1b32f" name="Note2" type="Note"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-330</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="82eb6625-4dfb-463a-8d54-476c63afbac1" name="Note2" type="Note"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-180</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d3d36a18-f456-480b-9d41-37c5d0694534" name="Both Search Strings Empty?" type="Decision"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Row Value] = &quot;&quot;" /><ontrue>9a1bbb2a-1bf5-4106-8f37-6c2e443e4ef4</ontrue><onfalse>62ff826d-f515-4934-a75b-59b24775da95</onfalse></stage><stage stageid="58ed030a-8006-4105-9773-a7541662b4e4" name="Trim Search Strings" type="MultipleCalculation"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d3d36a18-f456-480b-9d41-37c5d0694534</onsuccess><steps><calculation expression="Trim([Row Value])" stage="Row Value" /></steps></stage><stage stageid="9a1bbb2a-1bf5-4106-8f37-6c2e443e4ef4" name="anchor3" type="Anchor"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>53f44658-4509-4ed8-b4ae-ccfa30875454</onsuccess></stage><stage stageid="53f44658-4509-4ed8-b4ae-ccfa30875454" name="anchor4" type="Anchor"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>90</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>b8717f16-a18a-4e48-baff-b73c0fe1977c</onsuccess></stage><stage stageid="44360001-b3bb-4d6e-8291-187162ffb6e7" name="Row Value" type="Data"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>-345</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="62ff826d-f515-4934-a75b-59b24775da95" name="Read Field11" type="Code"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><loginhibit /><narrative></narrative><displayx>-30</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll" expr="[Collection]" /><input type="text" name="FieldName" expr="[Column Name]" /><input type="text" name="RowValue" expr="[Row Value]" /></inputs><outputs><output type="number" name="Value_Read" stage="Row Index" /><output type="flag" name="Success" stage="Success" /></outputs><onsuccess>b8717f16-a18a-4e48-baff-b73c0fe1977c</onsuccess><code><![CDATA[Dim i As Integer
For i = 0 To Coll.Rows.Count - 1
            If Trim(Coll.Rows(i)(FieldName)) = RowValue Then
                Value_Read = i
Success = True
                Exit For
            End If
        Next
Value_Read = Value_Read +1

            If Success = False Then
Value_Read = 0
End If]]></code></stage><stage stageid="a92e3349-b32f-43c1-ad3d-e8d1f6168daa" name="Row Index" type="Data"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2c8d2aee-4513-404c-8b3b-44c96d3cd1ff" name="Success" type="Data"><subsheetid>2b9a5b17-bc84-4aa2-b0a1-e9b2c1286b6d</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d0ce381d-56e1-4771-964d-a2eb8a8e8d3b" name="Trim headers" type="SubSheetInfo"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><narrative></narrative><displayx>-180</displayx><displayy>-195</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ed7e4364-c5af-4f14-8fab-6a68f8040be6" name="Trim Header Text" type="Code"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Output Collection" stage="Output Collection" /></outputs><onsuccess>62ae411e-58c6-4a93-bf37-3143c55bac0d</onsuccess><code><![CDATA[For Each Column As DataColumn In Input_Collection.Columns
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName,Column.ColumnName,Trim(Column.ColumnName))
   Column.ColumnName=Microsoft.Visualbasic.Replace(Column.ColumnName, Chr(34), "", , , vbTextCompare)
Next
Output_Collection = Input_Collection]]></code></stage><stage stageid="62ae411e-58c6-4a93-bf37-3143c55bac0d" name="End" type="End"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="The collection with the renamed column" stage="Output Collection" /></outputs></stage><stage stageid="c02f00a2-88ca-452d-bf26-1f4506d316e6" name="Start" type="Start"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have fields with no dots." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection with the column to rename" stage="Input Collection" /></inputs><onsuccess>ed7e4364-c5af-4f14-8fab-6a68f8040be6</onsuccess></stage><stage stageid="7d74bb3a-d443-4806-80b6-e314a69118ce" name="Input Collection" type="Collection"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e07160e5-f69f-4ce2-91fd-727b2f0b5a90" name="Note1" type="Note"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-195</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5e40e7b2-70ea-4765-b31c-c1eb487cf3ce" name="Output Collection" type="Collection"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="3f388f35-c30f-4941-8493-8b6ff955d6e1" name="Note1" type="Note"><subsheetid>9f8f5c4e-bde6-4fce-9e17-d900f0bbf053</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="483d8b47-32e4-4caf-af7b-f1dd5a3f72f4" name="Distinct values in a column" type="SubSheetInfo"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f486ed29-42a3-4e0d-877a-8bad016b4f33" name="Start" type="Start"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" stage="Input Collection" /><input type="text" name="Column Name" stage="Column" /></inputs><onsuccess>9727a462-31f9-4619-931c-c8ac35386499</onsuccess></stage><stage stageid="6a9e8b6d-aead-4c2e-ba33-f5680ba5ce13" name="End" type="End"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="OutputCollection" stage="OutputCollection" /></outputs></stage><stage stageid="9727a462-31f9-4619-931c-c8ac35386499" name="Code1" type="Code"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="InputCollection" expr="[Input Collection]" /><input type="text" name="ColumnName" expr="[Column]" /></inputs><outputs><output type="collection" name="OutputCollection" stage="OutputCollection" /></outputs><onsuccess>6a9e8b6d-aead-4c2e-ba33-f5680ba5ce13</onsuccess><code><![CDATA[OutputCollection=InputCollection.DefaultView.ToTable(true,ColumnName)]]></code></stage><stage stageid="b9de1ad5-bacd-495b-bfb7-0bccfb781348" name="Input Collection" type="Collection"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><narrative></narrative><displayx>-150</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1c0e91da-2a5d-4c57-bb83-4ad83cc26191" name="Column" type="Data"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><narrative></narrative><displayx>-225</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="daf8e361-bd59-4d55-8079-aad093954caa" name="OutputCollection" type="Collection"><subsheetid>4c773bb1-3fe6-4fe1-a50f-9ccd296476c1</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cd8d4831-11e8-4679-94e1-7527508ec847" name="Add Value to Column(Text)" type="SubSheetInfo"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="bf43d2a5-f0b2-4d68-adbd-6bf149360ad8" name="Append Number - Incremental Values2" type="Code"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="text" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>5f4bd863-e119-4bdb-abc8-88742d0ae8ba</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.String"))
End If
For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
	
Next

New_Collection = Collection
]]></code></stage><stage stageid="73fa9df9-41b3-450a-ada2-c7b0cda40d15" name="Start" type="Start"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have the new field appended to it." /></postconditions><narrative></narrative><displayx>75</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="text" name="Value" narrative="The value to be put in the new field." stage="Value" /></inputs><onsuccess>bf43d2a5-f0b2-4d68-adbd-6bf149360ad8</onsuccess></stage><stage stageid="5f4bd863-e119-4bdb-abc8-88742d0ae8ba" name="End" type="End"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="32947336-cf36-451c-bdc4-732038a69a31" name="Collection Out" type="Collection"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="60a11836-a5be-4747-9fdd-f90c14d9b32a" name="Field Name" type="Data"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>45</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b8e8b115-c9e1-45d8-be87-dfb5fb62f10a" name="Collection In" type="Collection"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="0955325c-60dc-4004-a4c9-f98ba647363f" name="Value" type="Data"><subsheetid>e541422a-fb55-4817-9547-5cdcd3fe77cf</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="968b2b47-a908-48c2-8bce-32b48bf7ec2a" name="Sum Values" type="SubSheetInfo"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative>Sums values of a column</narrative><displayx>-435</displayx><displayy>-210</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5c9261ef-5de5-4b95-af63-becc226642e1" name="Start" type="Start"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="FieldName" stage="FieldName" /><input type="collection" name="Source Collection" stage="Source Collection" /></inputs><onsuccess>09ea5c98-20cb-4036-9ec3-ab396d3bea31</onsuccess></stage><stage stageid="fe7f8ff0-a879-49df-8c59-dd7f0f4d740b" name="End" type="End"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Value" stage="Value" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error_Message" stage="Error_Message" /></outputs></stage><stage stageid="a76c5470-c2dc-4ee7-9104-fe65d6b88bc9" name="Source Collection" type="Collection"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>-270</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="09ea5c98-20cb-4036-9ec3-ab396d3bea31" name="Sum Values" type="Code"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-30</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll" expr="[Source Collection]" /><input type="text" name="FieldName" expr="[FieldName]" /></inputs><outputs><output type="number" name="Value_Fin" stage="Value" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error_Message" stage="Error_Message" /></outputs><onsuccess>f4974de8-d261-43ac-a422-8bded0fe9884</onsuccess><code><![CDATA[Try
Dim i As Integer
Dim Value as Integer
Value = Coll.Rows(0)(FieldName)
For i = 1 To Coll.Rows.Count - 1
            Value = Value + Coll.Rows(i)(FieldName)
Next
Value_Fin=Value
Success = True
Catch Ex As Exception
	Success = False
	Error_Message = Ex.ToString()
end Try]]></code></stage><stage stageid="f4974de8-d261-43ac-a422-8bded0fe9884" name="Success?" type="Decision"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>fe7f8ff0-a879-49df-8c59-dd7f0f4d740b</ontrue><onfalse>3e29500b-1918-4a61-bdc3-a84afb432f76</onfalse></stage><stage stageid="3e29500b-1918-4a61-bdc3-a84afb432f76" name="System Exception" type="Exception"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>90</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="[Error_Message]" /></stage><stage stageid="973b263f-0bc5-4b35-bfbe-f5d05ddead15" name="FieldName" type="Data"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>-375</displayx><displayy>-75</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Column</initialvalue><private /><alwaysinit /></stage><stage stageid="6a2507fc-6010-46ac-8759-b515d796a6c0" name="Value" type="Data"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>-375</displayx><displayy>15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="2b09a7f5-eebb-4893-9be4-2ea166ea0baa" name="Error_Message" type="Data"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>-390</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7c7ab4e4-2347-4028-9da0-ff915bc01775" name="Success" type="Data"><subsheetid>45722e3e-ba81-4faa-b738-0f7e569f2a40</subsheetid><narrative></narrative><displayx>-270</displayx><displayy>60</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1810a56f-0941-49e2-8ea7-39aab38eec3a" name="Field Exists" type="SubSheetInfo"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><narrative>Finds out whether the collection contatins a given field.</narrative><displayx>-135</displayx><displayy>-120</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f494c8b4-45ba-4b0f-80f4-b1ff625e9ef6" name="Start" type="Start"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><narrative></narrative><displayx>75</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection to check." stage="Input Collection" /><input type="text" name="Field" narrative="The field to check for." stage="Field" /></inputs><onsuccess>2bd69798-7e02-470e-8007-a4056c54f0d7</onsuccess></stage><stage stageid="367b796c-1aee-47a6-96bf-d5d70986afe1" name="End" type="End"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>255</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Exists" narrative="True if the collection contains the field." stage="Exists" /></outputs></stage><stage stageid="2bd69798-7e02-470e-8007-a4056c54f0d7" name="Get Collection Fields" type="SubSheet"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" expr="[Input Collection]" /></inputs><outputs><output type="collection" name="Collection Fields" stage="Field Names" /></outputs><onsuccess>02ae09bf-999e-4bad-b369-f23e2bf9ad39</onsuccess><processid>e277cc2b-72b8-47e9-8a1b-e8530eb19a09</processid></stage><stage stageid="f8cb67f4-2905-492b-b4ca-2e0648437f11" name="Input Collection" type="Collection"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="34ba139d-ff3d-417f-8c85-c5ed3e7281a7" name="Field" type="Data"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="02ae09bf-999e-4bad-b369-f23e2bf9ad39" name="Field Names" type="LoopStart"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>e190380a-25e5-4bc2-bf4e-c76525d63532</onsuccess><groupid>fc06df3a-9a9a-421d-abca-d99c9f6db2f9</groupid><looptype>ForEach</looptype><loopdata>Field Names</loopdata></stage><stage stageid="6e0bd0b9-e099-4791-972d-d457f3006ed6" name="Field Names" type="LoopEnd"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>195</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>367b796c-1aee-47a6-96bf-d5d70986afe1</onsuccess><groupid>fc06df3a-9a9a-421d-abca-d99c9f6db2f9</groupid></stage><stage stageid="566cbc0c-9249-4137-8ed1-604c8daa9b5d" name="Field Names" type="Collection"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Field Name" type="text" /><field name="Data Type" type="text" /></collectioninfo></stage><stage stageid="6c0f2682-1962-4bb6-b9ed-3b85f74d615c" name="Exists" type="Data"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><narrative></narrative><displayx>-135</displayx><displayy>255</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="e190380a-25e5-4bc2-bf4e-c76525d63532" name="Match?" type="Decision"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>120</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="Trim(Replace([Field Names.Field Name],&quot;:&quot;,&quot;&quot;)) = Trim(Replace([Field],&quot;:&quot;,&quot;&quot;))" /><ontrue>11d166e5-715e-412f-a54e-4d964e688634</ontrue><onfalse>6e0bd0b9-e099-4791-972d-d457f3006ed6</onfalse></stage><stage stageid="d820d0ac-2b47-4b80-b2c4-cccf3e6ed9ea" name="anchor2" type="Anchor"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>255</displayy><displaywidth>10</displaywidth><displayheight>10</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>367b796c-1aee-47a6-96bf-d5d70986afe1</onsuccess></stage><stage stageid="11d166e5-715e-412f-a54e-4d964e688634" name="Exists" type="Calculation"><subsheetid>02440e37-e805-4bfc-8bea-7d07952d6a7c</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d820d0ac-2b47-4b80-b2c4-cccf3e6ed9ea</onsuccess><calculation expression="True" stage="Exists" /></stage><stage stageid="ab2449b8-5b25-4244-96c8-9cb597df1c89" name="Add Value to Column(Text)" type="SubSheetInfo"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative>Add Text Value to column based on row filter/condition</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="0e524fdd-6f1d-4a3c-b89d-0ba79e43341c" name="Add Value to Column(Text)" type="Code"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><loginhibit /><narrative>Add Text Value to column based on row condition</narrative><displayx>-45</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="text" name="Value" expr="[Value]" /><input type="text" name="Select Condition" expr="[Filter]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>a0f6e98d-f10b-4f2b-92d0-ed3f053dd986</onsuccess><code><![CDATA[If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.String"))
End If
For Each parentRow As DataRow In Collection.Select(Select_Condition)
	parentRow(Column) = Value
Next
New_Collection = Collection]]></code></stage><stage stageid="df58e0c0-fe97-4732-be52-320167a71f04" name="Start" type="Start"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have the new field appended to it." /></postconditions><narrative></narrative><displayx>-45</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="text" name="Value" narrative="The value to be put in the new field." stage="Value" /><input type="text" name="Filter" narrative="The Filter Query" stage="Filter" /></inputs><onsuccess>0e524fdd-6f1d-4a3c-b89d-0ba79e43341c</onsuccess></stage><stage stageid="a0f6e98d-f10b-4f2b-92d0-ed3f053dd986" name="End" type="End"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><loginhibit /><narrative></narrative><displayx>-45</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="e85925c8-6869-4822-b72c-7464c88ad35a" name="Collection Out" type="Collection"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9dc33a7a-6796-4d76-83f2-79d2733fe73e" name="Field Name" type="Data"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="42a463c1-dea8-4a36-8919-00db10aabec6" name="Collection In" type="Collection"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="7f722982-150a-47c1-8017-325aec7c5003" name="Value" type="Data"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d4f470f1-ff9c-4acc-9af0-61a9842cb9dd" name="Filter" type="Data"><subsheetid>9ca43712-86a7-4260-bf89-f8b7518ddb60</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="12c3c961-674a-4e30-8f97-ce8825834cb4" name="CleanMemory" type="SubSheetInfo"><subsheetid>1123d57c-cfe8-424d-99a9-2d47860a0482</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="f298d83a-1c4a-4a07-81c2-c939363b46c8" name="Start" type="Start"><subsheetid>1123d57c-cfe8-424d-99a9-2d47860a0482</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>-75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>c265c249-c4f3-41c3-907c-632eae6a7a4b</onsuccess></stage><stage stageid="9b9ab26d-7d1f-4fcb-bd6d-5ac56db3bbda" name="End" type="End"><subsheetid>1123d57c-cfe8-424d-99a9-2d47860a0482</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="c265c249-c4f3-41c3-907c-632eae6a7a4b" name="Cleanup" type="Code"><subsheetid>1123d57c-cfe8-424d-99a9-2d47860a0482</subsheetid><loginhibit /><narrative></narrative><displayx>0</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><onsuccess>9b9ab26d-7d1f-4fcb-bd6d-5ac56db3bbda</onsuccess><code><![CDATA[GC.Collect()
GC.WaitForPendingFinalizers()]]></code></stage><stage stageid="47d8a65c-067e-4fe3-be1f-0e0a4ff86e03" name="ReplaceCollectionValues" type="SubSheetInfo"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><narrative>Trim all the values in Collection and remove extra spaces.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7b7ddedf-c880-44ce-83cc-c756852d2655" name="Start" type="Start"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have empty rows removed." /></postconditions><narrative></narrative><displayx>-15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to remove empty rows from" stage="Collection In" /><input type="text" name="ReplaceWhat" narrative="Have to pass value or special characters to be replaced. Eg : For tab &quot;&#x9;&quot;" stage="ReplaceWhat" /><input type="text" name="ReplaceWith" narrative="Have to pass value or special characters to be replaced with. Eg : For Null &quot;&quot;" stage="ReplaceWith" /></inputs><onsuccess>1429e7e5-6e0e-4b62-9a0c-3849b751d599</onsuccess></stage><stage stageid="382ac653-f443-4727-aa5d-70171d4599e1" name="End" type="End"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with the empty rows removed" stage="Collection Out" /></outputs></stage><stage stageid="68b05404-b6e3-46ea-a184-36d76a0a493b" name="Collection In" type="Collection"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><narrative></narrative><displayx>60</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="48287121-c41b-4506-af88-da92f95bf26b" name="Collection Out" type="Collection"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><narrative></narrative><displayx>60</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="1429e7e5-6e0e-4b62-9a0c-3849b751d599" name="Replace Collection Values" type="Code"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /><input type="text" name="ReplaceWhat" expr="[ReplaceWhat]" /><input type="text" name="ReplaceWith" expr="[ReplaceWith]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>382ac653-f443-4727-aa5d-70171d4599e1</onsuccess><code><![CDATA[
'Dim bRemove as Boolean
Dim iRow as integer
' Loop through each row

For iRow = Collection_In.Rows.Count - 1 to 0 step -1
	' Loop through every column for this row
	For each Column as DataColumn in Collection_In.Columns
		Collection_In.Rows(iRow)(Column.ColumnName) = Trim(Collection_In.Rows(iRow)(Column.ColumnName).ToString().Replace(ReplaceWhat,ReplaceWith))

	Next
Next

Collection_Out = Collection_In.Copy]]></code></stage><stage stageid="03df0371-850a-4013-b2d8-0734dd942a75" name="ReplaceWhat" type="Data"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">Sangavi</initialvalue><private /><alwaysinit /></stage><stage stageid="b7d21823-e298-4663-829b-073cb608e308" name="ReplaceWith" type="Data"><subsheetid>34b3f311-667d-4be9-9fad-2ae5aa1abba8</subsheetid><loginhibit /><narrative></narrative><displayx>195</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue xml:space="preserve">ADP</initialvalue><private /><alwaysinit /></stage><stage stageid="02f3f262-a172-4f1d-8f75-0ace6e73233d" name="Trim Values in a Collection" type="SubSheetInfo"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><narrative>Trim all the values in Collection and remove extra spaces.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="a224918f-1539-4446-ba53-86114133596c" name="Start" type="Start"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have empty rows removed." /></postconditions><narrative></narrative><displayx>-15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" narrative="The collection to remove empty rows from" stage="Collection In" /></inputs><onsuccess>5ca70815-9834-40ed-94d3-8a5315c51f13</onsuccess></stage><stage stageid="d20db7ba-95f6-444e-a35c-6751e7d2d5e7" name="End" type="End"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Collection Out" narrative="The collection with the empty rows removed" stage="Collection Out" /></outputs></stage><stage stageid="50d7eb4f-5069-4554-95fe-e4433e479ac6" name="Collection In" type="Collection"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><narrative></narrative><displayx>60</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5b01ec23-f1b1-489b-9bb8-38b0c046fb20" name="Collection Out" type="Collection"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><narrative></narrative><displayx>60</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5ca70815-9834-40ed-94d3-8a5315c51f13" name="Trim Values in a collection" type="Code"><subsheetid>43162cbb-b906-4c41-bb49-1dea3a97055d</subsheetid><loginhibit /><narrative></narrative><displayx>-15</displayx><displayy>-15</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection In" expr="[Collection In]" /></inputs><outputs><output type="collection" name="Collection Out" stage="Collection Out" /></outputs><onsuccess>d20db7ba-95f6-444e-a35c-6751e7d2d5e7</onsuccess><code><![CDATA[
'Dim bRemove as Boolean
Dim iRow as integer
' Loop through each row

For iRow = Collection_In.Rows.Count - 1 to 0 step -1
	' Loop through every column for this row
	For each Column as DataColumn in Collection_In.Columns
		Collection_In.Rows(iRow)(Column.ColumnName) = Trim(Collection_In.Rows(iRow)(Column.ColumnName).ToString())

	Next
Next

Collection_Out = Collection_In.Copy]]></code></stage><stage stageid="6739eed7-cee7-4547-8e3b-0cb4ab9811be" name="Find Sum Based In Column" type="SubSheetInfo"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="0aaaa049-1c8e-42e7-92b1-5ca7663d9a5d" name="Start" type="Start"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="InputCollection" stage="InputCollection" /><input type="collection" name="UniqueCollection" stage="UniqueCollection" /><input type="text" name="NewColumnName" stage="NewColumnName" /><input type="text" name="Key Field" stage="Key Field" /><input type="text" name="SumColumnName" stage="SumColumnName" /></inputs><onsuccess>61e6894a-e9f7-406b-ac3f-c52cae1e2423</onsuccess></stage><stage stageid="98b2852a-53af-4cf6-9bce-c56acd47f764" name="End" type="End"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>210</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="OutputCollection" stage="OutputCollection" /></outputs></stage><stage stageid="61e6894a-e9f7-406b-ac3f-c52cae1e2423" name="Find Sum" type="Code"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="InputCollection" expr="[InputCollection]" /><input type="collection" name="UniqueCollection" expr="[UniqueCollection]" /><input type="text" name="KeyField" expr="[Key Field]" /><input type="text" name="NewColumnName" expr="[NewColumnName]" /><input type="text" name="SumColumnName" expr="[SumColumnName]" /></inputs><outputs><output type="collection" name="OutputCollection" stage="OutputCollection" /><output type="text" name="Error Message" stage="Message" /><output type="flag" name="Success" stage="Success" /></outputs><onsuccess>c4ceb838-6032-450c-af6b-ab6ea23e51f6</onsuccess><code><![CDATA[Try
Dim Sum as Decimal
Sum=0
UniqueCollection.Columns.Add(NewColumnName, GetType(DECIMAL))
For Each row As DataRow in UniqueCollection.Rows


       For Each parentRow As DataRow In InputCollection.Select("["& KeyField &"] = '"&row.Item(KeyField)&"'")


Sum  = Sum + Cdec(parentRow(SumColumnName))
Next
row(NewColumnName) = sum
sum=0
Next



OutputCollection = UniqueCollection

Success = True

Catch ex as Exception
Error_Message = ex.ToString()
Success = False

End Try

]]></code></stage><stage stageid="11402966-ad0d-4821-9114-646e54d60d30" name="InputCollection" type="Collection"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>-480</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2a8ee3ab-9cc8-4976-9a2f-cbcf15f1d938" name="UniqueCollection" type="Collection"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>-345</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="78323f5e-fb75-45f4-9588-96023a69c6d0" name="OutputCollection" type="Collection"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>285</displayx><displayy>-30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="21e12225-b501-4981-9de9-84dc9fd5f778" name="Success" type="Data"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>300</displayx><displayy>-150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3ee0b24d-6cfd-40ae-82e0-ff462bb5074b" name="Message" type="Data"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>420</displayx><displayy>-150</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="656ca351-280b-4a8f-aa7a-4ddf14494e02" name="NewColumnName" type="Data"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>-390</displayx><displayy>120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8c318b5e-802f-4879-8ac3-33d3174002ed" name="Key Field" type="Data"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>-510</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c4ceb838-6032-450c-af6b-ab6ea23e51f6" name="Success?" type="Decision"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>98b2852a-53af-4cf6-9bce-c56acd47f764</ontrue><onfalse>79985f18-6226-449d-b8f4-a34c23257a4d</onfalse></stage><stage stageid="79985f18-6226-449d-b8f4-a34c23257a4d" name="Fail" type="Exception"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><narrative></narrative><displayx>165</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><exception localized="yes" type="UtilityException" detail="&quot;Error Occured during  Summation of column:&quot; &amp;[Message]" /></stage><stage stageid="392687ab-49ad-407d-9069-44bcaa6a3b41" name="SumColumnName" type="Data"><subsheetid>c8c48625-056a-468c-a1ab-36e4f088b85c</subsheetid><loginhibit /><narrative></narrative><displayx>-300</displayx><displayy>135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ef038e7f-1ce4-4f43-8d24-cf9829b59099" name="Append Field (DateTime)" type="SubSheetInfo"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><narrative>Appends a field to a collection and allows you to provide a default value as text fot the field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="effe4577-e33b-4b0e-9cc1-eeb8c657cb9f" name="Field Name" type="Data"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6f38f282-5057-4a79-8686-bc7adce312c3" name="Append Date" type="Code"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="date" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>540c2812-a926-4595-89cd-389189be7126</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, Type.GetType("System.DateTime"))
End If

For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
Next

New_Collection = Collection
]]></code></stage><stage stageid="0a56ace2-debf-47d1-b711-edb0a087e616" name="Collection Out" type="Collection"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>120</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="baa77795-1b2d-409f-b60a-dbe1430571c9" name="Collection In" type="Collection"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9b346e04-060e-433c-9188-7b6c1ae3274d" name="Value" type="Data"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>datetime</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="46efd497-486e-46cb-a719-cfbd57c17d2e" name="Start" type="Start"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have a new field appended to it." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="datetime" name="Value" narrative="The value to be put in the new field." stage="Value" /></inputs><onsuccess>6f38f282-5057-4a79-8686-bc7adce312c3</onsuccess></stage><stage stageid="540c2812-a926-4595-89cd-389189be7126" name="End" type="End"><subsheetid>7a34b011-0bb7-4f26-b061-298b3c067161</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="eedca116-2105-4197-b21c-8a03f0b99e7b" name="Compare Single Col Collection - Returns Unmatched Values" type="SubSheetInfo"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><narrative>This action compares single column collection with Master collection (having single column list values only) for its values and returns the unmatched items found in a collection
Column Name should be "Field Name"</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="66ff6613-37e8-40fa-8cfc-3b1c60542919" name="Start" type="Start"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Master collection" stage="Master Collection" /><input type="collection" name="Comparing Collection" stage="Comparing Collection" /></inputs><onsuccess>f4f75d7b-d6c8-4c63-af6b-c28171a310f6</onsuccess></stage><stage stageid="f27b66cf-bf19-4fc3-8c06-6c700cd35d03" name="End" type="End"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>165</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Missing Values" stage="Missing Values" /></outputs></stage><stage stageid="f4f75d7b-d6c8-4c63-af6b-c28171a310f6" name="Get Column Unique Data" type="Code"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative>This operation compares single column collections with Master collection (having single column list values only) for its values and returns the unequal items found in a collection</narrative><displayx>15</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Coll1" expr="[Master Collection]" /><input type="collection" name="Coll2" expr="[Comparing Collection]" /></inputs><outputs><output type="collection" name="Out" stage="Missing Values" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>d94f6ddd-4ac5-4594-93cf-56674a232d5e</onsuccess><code><![CDATA[Try
out = coll1.clone
dim found as boolean
dim j as integer

	for each row as datarow in coll2.rows
found = false
		for j = 0 to coll1.rows.count - 1
			If Ucase(Trim(Coll1.rows(j).item("Field Name")).tostring) = Ucase(Trim(row("Field Name")).tostring) then
				found = true
				goto finish:
			End if
		Next
		finish:
	If found = false then
		out.importrow(row)
	end if
		next
       Success = True
       Message = ""

Catch e As Exception

            Success = False

            Message = e.Message

End Try
]]></code></stage><stage stageid="6561d4ee-5f3a-41f1-84cf-9dfc26216f06" name="Master Collection" type="Collection"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>-75</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="a3a6ec04-1755-4da4-9945-4c503319eb33" name="Comparing Collection" type="Collection"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>0</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="5bfd6909-609a-45ea-87c4-1135c9ace971" name="Missing Values" type="Collection"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>210</displayx><displayy>105</displayy><displaywidth>90</displaywidth><displayheight>60</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f6afd560-5ee9-4082-a216-30cb3be1665e" name="Success" type="Data"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="abc4bada-fb41-45ca-a9d0-c73656e82a6d" name="Message" type="Data"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d94f6ddd-4ac5-4594-93cf-56674a232d5e" name="Success?" type="Decision"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>f27b66cf-bf19-4fc3-8c06-6c700cd35d03</ontrue><onfalse>06943806-1812-4ce9-92b2-b41fecd48248</onfalse></stage><stage stageid="06943806-1812-4ce9-92b2-b41fecd48248" name="System Exception" type="Exception"><subsheetid>7e683388-9c88-4ec1-9198-ae559b6488cf</subsheetid><narrative></narrative><displayx>105</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="&quot;Unable to compare collection column. Exception Reason : &quot;&amp;[Message]" /></stage><stage stageid="aaa9ea47-518a-4790-b1e4-1b631c32f90e" name="Compare Collections - Returns matched Values" type="SubSheetInfo"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative>Compares two collections and returns the matched values</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="613479d0-1951-4fcf-9807-92d79f49ac12" name="Start" type="Start"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><preconditions><condition narrative="A collection exists with the specified column name which may or may not contain a particular value" /><condition narrative="The collection being searched has no date or time columns (A code stage restriction)" /></preconditions><postconditions><condition narrative="No change" /></postconditions><narrative>Note that if neither 'Exact Value' nor 'Regex' are supplied, this will always return FALSE / ie. not found. If a match is found, groups will return all of the groups specified in the regular expression when applied to the value found.</narrative><displayx>270</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" narrative="Required : The collection to search" stage="Main Collection" /><input type="text" name="Main colname" narrative="Required : The column where to search" stage="Main colname" /><input type="collection" name="Secondary Collection" narrative="Required : The collection to search" stage="Secondary Collection" /><input type="text" name="Secondary colname" narrative="Required : The column where to search" stage="Secondary colname" /></inputs><onsuccess>61e151b2-95fa-431c-ad6e-d7450a3bdcc6</onsuccess></stage><stage stageid="24e11728-67a3-4ca5-aa9f-12ed87e0849d" name="End" type="End"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Contains Search Term" narrative="Flag indicating if the collection found the given search term or not" stage="Contains Search Term" /><output type="collection" name="Output" narrative="The output will have specific rows" stage="Output" /></outputs></stage><stage stageid="17a22d1e-da3e-496f-b31a-1a1eb8277314" name="Main Collection" type="Collection"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>-45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="711ed79f-ebee-4e39-ae8a-c22b5d5c4ea1" name="Contains Search Term" type="Data"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>120</displayx><displayy>-45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="99d3caf0-3051-4d89-b467-ae19412eb9b6" name="Note2" type="Note"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><narrative>Inputs</narrative><displayx>-30</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="501a2fbf-9254-4445-b193-53ab22f0a68d" name="Note2" type="Note"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><narrative>Outputs</narrative><displayx>120</displayx><displayy>-75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="61e151b2-95fa-431c-ad6e-d7450a3bdcc6" name="Compare Collections" type="Code"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>-45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Main Collection" expr="[Main Collection]" /><input type="text" name="Main colname" expr="[Main colname]" /><input type="collection" name="Secondary Collection" expr="[Secondary Collection]" /><input type="text" name="Secondary colname" expr="[Secondary colname]" /></inputs><outputs><output type="flag" name="found" stage="Contains Search Term" /><output type="collection" name="Output" stage="Output" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>4fd52196-ef1a-48d1-914a-d1610df821cf</onsuccess><code><![CDATA[Try
If Not Main_Collection.Columns.Contains(Main_colname) Then
  Throw New ApplicationException(String.Format( _
   "The collection does not contain a field " & _
   "with the name '{0}'", Main_colname))
End If
If Not Secondary_Collection.Columns.Contains(Secondary_colname) Then
  Throw New ApplicationException(String.Format( _
   "The collection does not contain a field " & _
   "with the name '{0}'", Secondary_colname))
End If

' Initialise output params
found = False
Output = New DataTable()
	For J As Integer = 0 To Main_Collection.Columns.Count - 1
		Output.Columns.Add(Main_Collection.Columns(J).ColumnName, Main_Collection.Columns(J).DataType)
	Next

For Each row as DataRow in Main_Collection.Rows
Dim exactVal as String = CStr(row(Main_colname))

		For Each row1 as DataRow in Secondary_Collection.Rows
		Dim val as String = CStr(row1(Secondary_colname))
 ' Dim m as Match = rx.Match(val)
 ' If m.Success Then
			If Ucase(val) like Ucase(exactVal) then
			found = True
'			Dim Values(Secondary_Collection.Columns.Count - 1) As Object
			Dim Values(Main_Collection.Columns.Count - 1) As Object
'				For J As Integer = 0 To Secondary_Collection.Columns.Count - 1
				For J As Integer = 0 To Main_Collection.Columns.Count - 1
					Values(J) = row(J)
				Next
			output.Rows.Add (Values)
		End If
		Next
Next
Success = True
       Message = ""

Catch e As Exception

            Success = False

            Message = e.Message

End Try
]]></code></stage><stage stageid="a1475c2e-949b-4070-a925-d271f533ff30" name="Output" type="Collection"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>120</displayx><displayy>0</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="4850579c-6624-4d67-9b22-b8bcf759ba30" name="Main colname" type="Data"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="daaf421e-e29f-419d-91cf-27972d840662" name="Secondary Collection" type="Collection"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>-15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="146058d2-9286-4490-94f2-bea5798db53d" name="Secondary colname" type="Data"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>-30</displayx><displayy>45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="dcf3a9f9-06b8-4197-a78d-bbae3b514382" name="Success" type="Data"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>375</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d9143d46-fbef-46a6-90cd-47bedc0961d3" name="Message" type="Data"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>450</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4fd52196-ef1a-48d1-914a-d1610df821cf" name="Success?" type="Decision"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><loginhibit /><narrative></narrative><displayx>270</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>24e11728-67a3-4ca5-aa9f-12ed87e0849d</ontrue><onfalse>95ecb25a-e84e-43da-8ad9-e98edd34cbdd</onfalse></stage><stage stageid="95ecb25a-e84e-43da-8ad9-e98edd34cbdd" name="System Exception" type="Exception"><subsheetid>822edf4b-c142-4457-a8ff-4ff1eb0e5b2c</subsheetid><narrative></narrative><displayx>360</displayx><displayy>15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="System Exception" detail="&quot;Unable to compare collections. Exception Reason : &quot;&amp;[Message]" /></stage><stage stageid="07c58e8a-562c-475e-91c7-80fc20aff7e2" name="Fill Blanks  with Value" type="SubSheetInfo"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><narrative>Fills a collection that has empty values with empty text.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5bbc0249-198d-419c-9f8d-fe3c241d9d5d" name="Start" type="Start"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have its empty values filled with empty text." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Blanks" narrative="A collection with blank text fields" stage="Blanks" /><input type="text" name="Value" stage="Value" /></inputs><onsuccess>b73e0732-044b-4d03-9e18-17ca6fb3132f</onsuccess></stage><stage stageid="3edbe218-0e35-4535-a287-fad8c1632f8b" name="End" type="End"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="No Blanks" narrative="The collection with empty string instead of blanks" stage="No Blanks" /></outputs></stage><stage stageid="beb8b603-f9fd-4770-a6a9-5b46464ebac2" name="Blanks" type="Collection"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>0</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="2371d3e6-e93d-4e9d-addb-3e62c358c04b" name="No Blanks" type="Collection"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="b73e0732-044b-4d03-9e18-17ca6fb3132f" name="Fill Blanks with Value" type="Code"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Blanks" expr="[Blanks]" /><input type="text" name="Value" expr="[Value]" /></inputs><outputs><output type="collection" name="No Blanks" stage="No Blanks" /></outputs><onsuccess>3edbe218-0e35-4535-a287-fad8c1632f8b</onsuccess><code><![CDATA[try
  for each dr as datarow in blanks.rows
    for each c as datacolumn in blanks.columns
      if isdbnull(dr(c.columnname)) then
        dr(c.columnname) = Value
      end if
    next
  next
  no_blanks = blanks
catch e as exception

end try]]></code></stage><stage stageid="32b5a0ac-5525-422a-8f8d-c40a284a1e18" name="Value" type="Data"><subsheetid>980e41ce-f2f3-42fd-8da9-c3d63784d0a8</subsheetid><narrative></narrative><displayx>105</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="bd94693a-a034-4e54-ac61-7256cb96ce20" name="Append Field (DateTime)" type="SubSheetInfo"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><narrative>Appends a field to a collection and allows you to provide a default value as text fot the field.</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="4ae0aabd-5e7b-4324-a321-f984b2602b57" name="Field Name" type="Data"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ba987289-d4f3-4592-870a-204a60ce08de" name="Append Collection" type="Code"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-45</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="collection" name="Value" expr="[Collection Value]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>0f67d056-15d2-415b-a489-b12cfdfc43fc</onsuccess><code><![CDATA[
If Not Collection.Columns.Contains(Column) Then
	Collection.Columns.Add(Column, GetType(DataTable))
End If

For Each dr As System.Data.DataRow In Collection.Rows
	dr(Column) = Value
Next

New_Collection = Collection
]]></code></stage><stage stageid="8dd60222-4559-459d-8a33-d6aacfe4558c" name="Collection Out" type="Collection"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>150</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="9653fe0e-632b-47c4-9379-82e03ded69b7" name="Collection In" type="Collection"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>-15</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="0260afcc-d5bf-454d-9522-2c187356a3b1" name="Start" type="Start"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collection will have a new field appended to it." /></postconditions><narrative></narrative><displayx>15</displayx><displayy>-135</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="collection" name="Value" narrative="The value to be put in the new field." stage="Collection Value" /></inputs><onsuccess>ba987289-d4f3-4592-870a-204a60ce08de</onsuccess></stage><stage stageid="0f67d056-15d2-415b-a489-b12cfdfc43fc" name="End" type="End"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="984a48d7-de04-445f-9333-3a0e96615bf4" name="Collection Value" type="Collection"><subsheetid>dedeacd7-8e54-456e-920c-c23fc62e5789</subsheetid><narrative></narrative><displayx>-195</displayx><displayy>75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="cd5c4be9-a9a8-436c-94f3-9b4be3be398b" name="Custom_Add Column" type="SubSheetInfo"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative>It Will Add  the Column for given collection.
Dev: Sunil</narrative><displayx>-165</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="8b3b8514-7a49-49d1-bd0b-d49840fe294d" name="Start" type="Start"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><loginhibit /><preconditions><condition narrative="None." /></preconditions><postconditions><condition narrative="The collections field will have been removed." /></postconditions><narrative></narrative><displayx>105</displayx><displayy>-120</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Input Collection" narrative="The collection from which you want to delete a column from" stage="Input Collection" /><input type="text" name="Column Name" narrative="The column number to delete" stage="Column Name" /></inputs><onsuccess>02973b03-7be3-4380-9237-d88bd8965b0a</onsuccess></stage><stage stageid="62d907da-5915-4bda-b7e7-d742789ff893" name="End" type="End"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>75</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output Collection" narrative="A collection with a column removed" stage="Output Collection" /><output type="flag" name="Success" stage="Success" /><output type="text" name="Error Message" stage="Message" /></outputs></stage><stage stageid="02973b03-7be3-4380-9237-d88bd8965b0a" name="Add Column" type="Code"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><loginhibit /><narrative></narrative><displayx>105</displayx><displayy>-30</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="BP Collection In" expr="[Input Collection]" /><input type="text" name="Column Name" expr="[Column Name]" /></inputs><outputs><output type="collection" name="BP Collection Out" stage="Output Collection" /><output type="text" name="Error Message" stage="Message" /><output type="flag" name="Success" stage="Success" /></outputs><onsuccess>62d907da-5915-4bda-b7e7-d742789ff893</onsuccess><code><![CDATA[BP_Collection_Out = BP_Collection_In
BP_Collection_Out.Columns.Add(Column_Name)
]]></code></stage><stage stageid="7e849fb5-4160-43a1-99ba-6ccc8aeb328e" name="Input Collection" type="Collection"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative></narrative><displayx>210</displayx><displayy>-120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="e8a79850-4784-4d1f-b86c-843768743475" name="Output Collection" type="Collection"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative></narrative><displayx>210</displayx><displayy>75</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="58765bd3-cbba-456a-8872-2c52cde73190" name="Column Name" type="Data"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative></narrative><displayx>300</displayx><displayy>-120</displayy><displaywidth>90</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="71612888-939d-4bf5-b0b2-19510ef06666" name="Message" type="Data"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>90</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f9934f6c-0999-45fa-9fb6-d0e3b52e7cac" name="Success" type="Data"><subsheetid>f9718f48-96ae-4df7-8125-63d99736f39e</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>60</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f967c42e-9df1-4e71-81cd-249a94e58498" name="Get 1 column from collection" type="SubSheetInfo"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><narrative>Action returns a single column from Input Collection</narrative><displayx>-195</displayx><displayy>-105</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="9c47b6e0-0386-4663-968c-b5bad9043d47" name="Start" type="Start"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Column_Name" narrative="Column to extract" stage="Column_Name" /><input type="collection" name="Input" narrative="Input Collection" stage="Input" /></inputs><onsuccess>25d3d4c9-e2f6-4ddf-9143-4ec5c31d4478</onsuccess></stage><stage stageid="f2235d62-b719-4b0b-b436-132f10b13f53" name="End" type="End"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Output" narrative="Output Collection" stage="Output" /></outputs></stage><stage stageid="25d3d4c9-e2f6-4ddf-9143-4ec5c31d4478" name="Get 1 column from collection" type="Code"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>15</displayx><displayy>-15</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Column_Name" expr="[Column_Name]" /><input type="collection" name="Input" expr="[Input]" /></inputs><outputs><output type="collection" name="Output" stage="Output" /></outputs><onsuccess>f2235d62-b719-4b0b-b436-132f10b13f53</onsuccess><code><![CDATA[Dim v As New System.Data.DataView(Input)
Output = v.ToTable(false, Column_Name)]]></code></stage><stage stageid="e986e2b6-2321-4272-bf2a-c2e4bdfae074" name="Input" type="Collection"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>30</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="224349e1-1908-429b-b143-7449289aecf7" name="Output" type="Collection"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>60</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="42168662-1ce5-4909-8883-626f443cb0f5" name="Column_Name" type="Data"><subsheetid>9afa76c4-d9c2-436f-ac8e-cc353d553f12</subsheetid><loginhibit /><narrative></narrative><displayx>-120</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="96f32290-1abc-4383-a747-1a87a25226c0" name="Add Prefix/Suffix to Column(Text)" type="SubSheetInfo"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative>Action will add prefix AND/OR suffix to specific column</narrative><displayx>-405</displayx><displayy>-180</displayy><displaywidth>150</displaywidth><displayheight>90</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /></stage><stage stageid="4c815d25-2863-4b68-9ce1-6cfaf26117a9" name="Add Prefix/Suffix to Column(Text)" type="Code"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>0</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" expr="[Collection In]" /><input type="text" name="Column" expr="[Field Name]" /><input type="text" name="Prefix" expr="[Prefix]" /><input type="text" name="Suffix" expr="[Suffix]" /><input type="flag" name="Ignore_Blank" expr="[Ignore Blank]" /></inputs><outputs><output type="collection" name="New Collection" stage="Collection Out" /></outputs><onsuccess>ec4ddbc4-1314-4e36-b9e6-6b76975ddefc</onsuccess><code><![CDATA[For Each dr As System.Data.DataRow In Collection.Rows
	If dr(Column)="" AND Ignore_Blank	
		Else dr(Column) = Prefix+dr(Column)+Suffix
	End If
Next

New_Collection = Collection
]]></code></stage><stage stageid="171a3699-621a-439b-b2c9-8bf8b41ebd68" name="Start" type="Start"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>-90</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="collection" name="Collection" narrative="The collection to append a field to." stage="Collection In" /><input type="text" name="Field Name" narrative="The name of the new field." stage="Field Name" /><input type="text" name="Prefix" narrative="Prefix value to insert in column values. (Keep BLANK to skip)" stage="Prefix" /><input type="text" name="Suffix" narrative="Suffixx value to insert in column values. (Keep BLANK to skip)" stage="Suffix" /><input type="flag" name="Ignore Blank" narrative="Ignore Blank Values. (DEFUALT = TRUE" stage="Ignore Blank" /></inputs><onsuccess>4c815d25-2863-4b68-9ce1-6cfaf26117a9</onsuccess></stage><stage stageid="ec4ddbc4-1314-4e36-b9e6-6b76975ddefc" name="End" type="End"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><loginhibit /><narrative></narrative><displayx>75</displayx><displayy>105</displayy><displaywidth>60</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="collection" name="Appended Collection" narrative="The collection with field appended." stage="Collection Out" /></outputs></stage><stage stageid="f8390a0f-2612-4d6c-895a-e4b6b032c44e" name="Collection Out" type="Collection"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>135</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="824386c6-a894-4cab-a8c1-27276abc8e34" name="Field Name" type="Data"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>-30</displayy><displaywidth>150</displaywidth><displayheight>30</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e0bccb69-74f2-4389-bef5-d4b508b23c32" name="Collection In" type="Collection"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>-75</displayy><displaywidth>150</displaywidth><displayheight>60</displayheight><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="f7727ef4-b8a0-4ad9-8724-6335cbe8e794" name="Suffix" type="Data"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>15</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="40beee7f-26ff-4f59-b6ed-2a83ec466d10" name="Prefix" type="Data"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>45</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a544819d-d4ea-4712-9bb6-c01313921eee" name="Ignore Blank" type="Data"><subsheetid>e64fbfd3-6797-49fd-a53e-3d80493aae66</subsheetid><narrative></narrative><displayx>-165</displayx><displayy>75</displayy><displaywidth>120</displaywidth><displayheight>30</displayheight><font family="Segoe UI" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage></process></object>
        <object-group id="3a9359ff-b17f-4523-8dee-174f3f077f44" name="_BP_OBJ" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="6f9680f1-616c-4884-b58c-42ed51446377" />
            </members>
        </object-group>
        <object-group id="9f36d336-85ee-437a-bb0b-b1f158b6f5fe" name="BP_OBJ" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="6f9680f1-616c-4884-b58c-42ed51446377" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>